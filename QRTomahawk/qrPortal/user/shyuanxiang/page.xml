<page>
  <controls count="24">
    <control type="DivRoot" pathname="/divRoot">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>703</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>ffffff</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <onControlLoad>//大眼睛系统
g5.bigeyeCurrent = 0;
g5.bigeyeUserClick = false;
g5.bigeyeRoot = ee.getControl("layoutyitem2");
g5.bigeyePage = new Array();
g5.bigeyePage.push(ee.getControl("panel1"));
g5.bigeyePage.push(ee.getControl("panel2"));
g5.bigeyePage.push(ee.getControl("panel3"));
g5.bigeyePage.push(ee.getControl("panel4"));
g5.bigeyeTimer = function() {
    ee.hideAllLayer(g5.bigeyeRoot);
    ee.showAni(g5.bigeyePage[g5.bigeyeCurrent]);
    g5.bigeyeCurrent = (g5.bigeyeCurrent + 1) % g5.bigeyePage.length;
    if (!g5.bigeyeUserClick) {
        g5.bigeyeTHandle = setTimeout(g5.bigeyeTimer, 5000);
    }
}
g5.bigeyeShow = function(pageIndex) {
    g5.bigeyeUserClick = true;
    g5.bigeyeCurrent = pageIndex % g5.bigeyePage.length;
    clearTimeout(g5.bigeyeTHandle);
    g5.bigeyeTimer();
}
g5.bigeyeTHandle = setTimeout(g5.bigeyeTimer, 10);

check();</onControlLoad>
    </control>
    <control type="LayoutY" pathname="/divRoot/layouty1">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>703</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fieldCount>5</fieldCount>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem1">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>62</height>
      <backgroundColor>f0f0f0</backgroundColor>
      <heavy>30</heavy>
    </control>
    <control type="LayoutX" pathname="/divRoot/layouty1/layoutyitem1/layoutx1">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>62</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem1/layoutx1/layoutxitem1">
      <left>0</left>
      <top>0</top>
      <width>416</width>
      <height>62</height>
      <backgroundColor>f0f0f0</backgroundColor>
      <backgroundImg>CPY0000.jpg</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <onClick>window.location.href = "http://mp.weixin.qq.com/s?__biz=MzAwODA0NDg4NA==&amp;mid=209811833&amp;idx=1&amp;sn=0839ef1e2ef64bb0740957abcc269715#rd";</onClick>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem1/layoutx1/layoutxitem2">
      <left>416</left>
      <top>0</top>
      <width>415</width>
      <height>62</height>
      <backgroundColor>d0d0d0</backgroundColor>
      <backgroundImg>CPY0001.jpg</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <onClick>window.location.href = "tel://400-025-6969";</onClick>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem2">
      <left>0</left>
      <top>62</top>
      <width>831</width>
      <height>310</height>
      <backgroundColor>d0d0d0</backgroundColor>
      <heavy>150</heavy>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel1">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>310</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundImg>be1.jpg</backgroundImg>
      <layerName>a1</layerName>
      <layerVisible>false</layerVisible>
      <aniAlpha>whiteAlpha:白色淡出</aniAlpha>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel2">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>310</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundImg>be2.jpg</backgroundImg>
      <layerName>a2</layerName>
      <layerVisible>false</layerVisible>
      <aniAlpha>whiteAlpha:白色淡出</aniAlpha>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel3">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>310</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundImg>be3.jpg</backgroundImg>
      <layerName>a3</layerName>
      <layerVisible>false</layerVisible>
      <aniAlpha>whiteAlpha:白色淡出</aniAlpha>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel4">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>310</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundImg>be4.jpg</backgroundImg>
      <layerName>a4</layerName>
      <aniAlpha>whiteAlpha:白色淡出</aniAlpha>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem3">
      <left>0</left>
      <top>372</top>
      <width>831</width>
      <height>124</height>
      <backgroundColor>f0f0f0</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <heavy>60</heavy>
    </control>
    <control type="LayoutX" pathname="/divRoot/layouty1/layoutyitem3/layoutx4">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>124</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem3/layoutx4/layoutxitem7">
      <left>0</left>
      <top>0</top>
      <width>69</width>
      <height>124</height>
      <backgroundColor>f0f0f0</backgroundColor>
      <heavy>10</heavy>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem3/layoutx4/layoutxitem8">
      <left>69</left>
      <top>0</top>
      <width>693</width>
      <height>124</height>
      <backgroundColor>d0d0d0</backgroundColor>
      <text>.</text>
      <fontSize>12</fontSize>
      <fontSizeAuto>25</fontSizeAuto>
      <fontColor>C04000</fontColor>
      <hAlign>left</hAlign>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem3/layoutx4/layoutxitem9">
      <left>762</left>
      <top>0</top>
      <width>69</width>
      <height>124</height>
      <backgroundColor>f0f0f0</backgroundColor>
      <heavy>10</heavy>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem4">
      <left>0</left>
      <top>496</top>
      <width>831</width>
      <height>104</height>
      <backgroundColor>d0d0d0</backgroundColor>
      <heavy>50</heavy>
    </control>
    <control type="LayoutX" pathname="/divRoot/layouty1/layoutyitem4/layoutx2">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>104</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem4/layoutx2/layoutxitem3">
      <left>0</left>
      <top>0</top>
      <width>416</width>
      <height>104</height>
      <backgroundColor>f0f0f0</backgroundColor>
      <backgroundImg>q1.jpg</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <onClick>window.location.href = "cache/qrProtal/user/shyuanxiang/page/vidio/yuangxiang-05.mp4";
</onClick>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem4/layoutx2/layoutxitem4">
      <left>416</left>
      <top>0</top>
      <width>415</width>
      <height>104</height>
      <backgroundColor>d0d0d0</backgroundColor>
      <backgroundImg>q2.jpg</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <onClick>window.location.href = "cache/qrPortal/user/shyuanxiang/page/yx/index.html";
</onClick>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem5">
      <left>0</left>
      <top>600</top>
      <width>831</width>
      <height>103</height>
      <backgroundColor>f0f0f0</backgroundColor>
      <heavy>50</heavy>
    </control>
    <control type="LayoutX" pathname="/divRoot/layouty1/layoutyitem5/layoutx3">
      <left>0</left>
      <top>0</top>
      <width>831</width>
      <height>103</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem5/layoutx3/layoutxitem5">
      <left>0</left>
      <top>0</top>
      <width>416</width>
      <height>103</height>
      <backgroundColor>f0f0f0</backgroundColor>
      <backgroundImg>q3.jpg</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <onClick>window.location.href = "cache/qrPortal/user/shyuanxiang/page/qualification.htm";
</onClick>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem5/layoutx3/layoutxitem6">
      <left>416</left>
      <top>0</top>
      <width>415</width>
      <height>103</height>
      <backgroundColor>d0d0d0</backgroundColor>
      <backgroundImg>q4.jpg</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <onClick>window.location.href = "cache/qrPortal/user/shyuanxiang/page/problems.htm";
</onClick>
    </control>
  </controls>
  <sqlResultSet count="0" />
  <taskSet count="1">
    <taskSetItem name="check">
      <script1>//参数全部在session里面了 
</script1>
      <script2><![CDATA[var accountName = session.get("accountName");
var code1 = session.get("code1");
var code2 = session.get("code2");
var sql, sqlResult;

//查询序列号是否存在
sql = "select * from qrMain where " +
    "accountName='" + db.encode(accountName) + "' " +
    "and qr2='" + db.encode(code2) + "' ";
sqlResult = db.executeQuery("QR", sql);
var rs = "";
var rc = 0;
var sn;
if (!db.read(sqlResult)) {
    rc = 10;
    rs = "您扫描的二维码是非法印刷产品";
} else {
    sn = db.getString(sqlResult,"qrBarcode");
}

//查询历史扫描情况
if (rc==0) {
    sql = "select count(*) as scanCount from scanLog where " +
        "accountName='" + db.encode(accountName) + "' " +
        "and qrBarcode='" + db.encode(sn) + "' ";
    sqlResult = db.executeQuery("QR", sql);
    if (!db.read(sqlResult)) {
        rc = 20;
        rs = "对不起，系统繁忙，请稍后再试";
    } else {
        var scanCount = db.getInt32(sqlResult, "scanCount");
        if (scanCount==0) {
            rc = 100;
            rs = "恭喜您购买的产品是原厂正品<br/>"+
                "出厂序列号：" + sn;
        } else {
            rc = 110;
            rs = "您购买的产品已经被扫描验证过" + scanCount + "次<br/>" +
                "请点击查看之前的扫描情况。<br/>" +
                "出厂序列号：" + sn;
        }
    }
    //写入本次扫描
    sql = "insert into scanLog (accountName, qrBarcode) values (" +
        "'" + db.encode(accountName) + "'," +
        "'" + db.encode(sn) + "')";
    db.executeNoneQuery("QR", sql);
}

eio.appendInt32(rc);
eio.appendString16(rs);

]]></script2>
      <script3><![CDATA[var rc = eio.readInt32();
var rs = eio.readString16();
ee.setText(
    ee.getControl("layoutxitem8"), 
    "上海元翔新材料防伪查询系统<br/>" + rs
);
]]></script3>
    </taskSetItem>
  </taskSet>
  <gridLines count="0" />
</page>