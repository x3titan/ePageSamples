<page>
  <controls count="16">
    <control type="DivRoot" pathname="/divRoot">
      <left>0</left>
      <top>0</top>
      <width>1374</width>
      <height>819</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>DCDCDC</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <backgroundImg>1_1920x1080.jpg</backgroundImg>
      <onPageCreate>//onPageCreate</onPageCreate>
      <onPageLoad>//onPageLoad</onPageLoad>
      <onControlLoad>//onControlLoad
/*onkeydown=function (e) {
    if(e.keyCode==13)login();
} */


setTimeout(function() {
    g5.token = eb.getCookie("pjToken");
    if (g5.token!=null) {
        g5.show(0);
        loginToken();
    } else {
        g5.show(1);
    }
}, 500);

setTimeout(function(){
    ee.autoResize = false;
},1000);
</onControlLoad>
    </control>
    <control type="Panel" pathname="/divRoot/panel8">
      <left>0</left>
      <top>364</top>
      <width>1374</width>
      <height>90</height>
      <topRatio>0.444444444444444</topRatio>
      <widthRatio>1</widthRatio>
      <heightRatio>0.10989010989011</heightRatio>
      <sizeRatio>0.0748752079866889</sizeRatio>
      <dockX>fill</dockX>
      <dockY>center</dockY>
      <backgroundImg>bg11.jpg</backgroundImg>
      <backgroundImgMode>stretch</backgroundImgMode>
    </control>
    <control type="Panel" pathname="/divRoot/panel5">
      <left>214</left>
      <top>185</top>
      <width>946</width>
      <height>448</height>
      <leftRatio>0.10648918469218</leftRatio>
      <topRatio>0.225885225885226</topRatio>
      <widthRatio>0.787021630615641</widthRatio>
      <heightRatio>0.547008547008547</heightRatio>
      <sizeRatio>0.473572938689218</sizeRatio>
      <dockX>center</dockX>
      <dockY>center</dockY>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel9">
      <left>64</left>
      <top>194</top>
      <width>366</width>
      <height>39</height>
      <leftRatio>0.0676532769556025</leftRatio>
      <topRatio>0.433035714285714</topRatio>
      <widthRatio>0.386892177589852</widthRatio>
      <heightRatio>0.0870535714285714</heightRatio>
      <sizeRatio>0.10655737704918</sizeRatio>
      <outerTop>200</outerTop>
      <backgroundColor>DCDCDC</backgroundColor>
      <text>1陪驾经销商后台管理系统</text>
      <fontFamily>黑体</fontFamily>
      <fontSize>22</fontSize>
      <fontColor>008080</fontColor>
      <fontBold>true</fontBold>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel7">
      <left>492</left>
      <top>106</top>
      <width>435</width>
      <height>221</height>
      <leftRatio>0.520084566596195</leftRatio>
      <topRatio>0.236607142857143</topRatio>
      <widthRatio>0.459830866807611</widthRatio>
      <heightRatio>0.493303571428571</heightRatio>
      <sizeRatio>0.508045977011494</sizeRatio>
      <backgroundColor>FFFFFF</backgroundColor>
      <backgroundImgMode>center</backgroundImgMode>
      <backgroundSkin>body2</backgroundSkin>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel7/panel3">
      <left>24</left>
      <top>42</top>
      <width>92</width>
      <height>21</height>
      <leftRatio>0.0551724137931034</leftRatio>
      <topRatio>0.190045248868778</topRatio>
      <widthRatio>0.211494252873563</widthRatio>
      <heightRatio>0.0950226244343891</heightRatio>
      <sizeRatio>0.228260869565217</sizeRatio>
      <text>手机号码</text>
      <fontSize>12</fontSize>
      <fontBold>true</fontBold>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel7/panel2">
      <left>24</left>
      <top>85</top>
      <width>92</width>
      <height>21</height>
      <leftRatio>0.0551724137931034</leftRatio>
      <topRatio>0.384615384615385</topRatio>
      <widthRatio>0.211494252873563</widthRatio>
      <heightRatio>0.0950226244343891</heightRatio>
      <sizeRatio>0.228260869565217</sizeRatio>
      <text>密　码</text>
      <fontSize>12</fontSize>
      <fontBold>true</fontBold>
      <hAlign>right</hAlign>
    </control>
    <control type="Edit" pathname="/divRoot/panel5/panel7/edit1">
      <left>127</left>
      <top>36</top>
      <width>261</width>
      <height>30</height>
      <leftRatio>0.291954022988506</leftRatio>
      <topRatio>0.16289592760181</topRatio>
      <widthRatio>0.6</widthRatio>
      <heightRatio>0.135746606334842</heightRatio>
      <sizeRatio>0.114942528735632</sizeRatio>
      <backgroundSkin>edit1</backgroundSkin>
    </control>
    <control type="Edit" pathname="/divRoot/panel5/panel7/edit2">
      <left>127</left>
      <top>80</top>
      <width>261</width>
      <height>30</height>
      <leftRatio>0.291954022988506</leftRatio>
      <topRatio>0.361990950226244</topRatio>
      <widthRatio>0.6</widthRatio>
      <heightRatio>0.135746606334842</heightRatio>
      <sizeRatio>0.114942528735632</sizeRatio>
      <backgroundSkin>edit1</backgroundSkin>
      <inputPassword>true</inputPassword>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel7/panel4">
      <left>260</left>
      <top>138</top>
      <width>128</width>
      <height>32</height>
      <leftRatio>0.597701149425287</leftRatio>
      <topRatio>0.624434389140272</topRatio>
      <widthRatio>0.294252873563218</widthRatio>
      <heightRatio>0.144796380090498</heightRatio>
      <sizeRatio>0.25</sizeRatio>
      <backgroundSkin>skin1004</backgroundSkin>
      <text><![CDATA[登 录 >>]]></text>
      <fontColor>FFFFFF</fontColor>
      <fontBold>true</fontBold>
      <cursor>pointer</cursor>
      <onClick>login();</onClick>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel7/panel1">
      <left>118</left>
      <top>138</top>
      <width>128</width>
      <height>32</height>
      <leftRatio>0.271264367816092</leftRatio>
      <topRatio>0.624434389140272</topRatio>
      <widthRatio>0.294252873563218</widthRatio>
      <heightRatio>0.144796380090498</heightRatio>
      <sizeRatio>0.25</sizeRatio>
      <backgroundSkin>skin1004</backgroundSkin>
      <text>重 置</text>
      <fontColor>FFFFFF</fontColor>
      <fontBold>true</fontBold>
      <cursor>pointer</cursor>
      <onClick>ee.setEditText(ee.getControl("edit1"),"");
ee.setEditText(ee.getControl("edit2"),"");

</onClick>
    </control>
    <control type="CheckBox" pathname="/divRoot/panel5/panel7/checkbox1">
      <left>5</left>
      <top>180</top>
      <width>47</width>
      <height>29</height>
      <leftRatio>0.0114942528735632</leftRatio>
      <topRatio>0.81447963800905</topRatio>
      <widthRatio>0.108045977011494</widthRatio>
      <heightRatio>0.131221719457014</heightRatio>
      <sizeRatio>0.617021276595745</sizeRatio>
      <backgroundImg>c1.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <backgroundImg1>c2.png</backgroundImg1>
      <backgroundImgMode1>fill</backgroundImgMode1>
      <onValueChange>if (value=="1") {
    ee.getControl("divRoot").dockX = "disabled";
    ee.getControl("divRoot").dockY = "disabled";
    ee.setRect(ee.getControl("divRoot"),0,0,1920,1080);    
} else {
    ee.getControl("divRoot").dockX = "fill";
    ee.getControl("divRoot").dockY = "fill";    
}



</onValueChange>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel7/panel12">
      <left>52</left>
      <top>180</top>
      <width>76</width>
      <height>29</height>
      <leftRatio>0.119540229885057</leftRatio>
      <topRatio>0.81447963800905</topRatio>
      <widthRatio>0.174712643678161</widthRatio>
      <heightRatio>0.131221719457014</heightRatio>
      <sizeRatio>0.381578947368421</sizeRatio>
      <bindControl>checkbox1</bindControl>
      <bindLeft>right</bindLeft>
      <bindTop>top</bindTop>
      <bindBottom>bottom</bindBottom>
      <text>锁定屏幕</text>
      <hAlign>left</hAlign>
      <cursor>pointer</cursor>
      <onClick>var c = ee.getControl("checkbox1");
ee.setCheckBoxValue(c, (c.checkValue+1)%2);
</onClick>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel6">
      <left>73</left>
      <top>230</top>
      <width>342</width>
      <height>27</height>
      <leftRatio>0.0771670190274841</leftRatio>
      <topRatio>0.513392857142857</topRatio>
      <widthRatio>0.361522198731501</widthRatio>
      <heightRatio>0.0602678571428571</heightRatio>
      <sizeRatio>0.0789473684210526</sizeRatio>
      <fontColor>008080</fontColor>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel10">
      <left>11</left>
      <top>139</top>
      <width>140</width>
      <height>39</height>
      <leftRatio>0.0116279069767442</leftRatio>
      <topRatio>0.310267857142857</topRatio>
      <widthRatio>0.147991543340381</widthRatio>
      <heightRatio>0.0870535714285714</heightRatio>
      <sizeRatio>0.278571428571429</sizeRatio>
      <outerTop>200</outerTop>
      <backgroundColor>DCDCDC</backgroundColor>
      <text>用户登录</text>
      <fontFamily>黑体</fontFamily>
      <fontSize>22</fontSize>
      <fontColor>FFFFFF</fontColor>
      <fontBold>true</fontBold>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel11">
      <left>149</left>
      <top>148</top>
      <width>96</width>
      <height>25</height>
      <leftRatio>0.157505285412262</leftRatio>
      <topRatio>0.330357142857143</topRatio>
      <widthRatio>0.101479915433404</widthRatio>
      <heightRatio>0.0558035714285714</heightRatio>
      <sizeRatio>0.260416666666667</sizeRatio>
      <text>User Login</text>
      <fontFamily>Arial</fontFamily>
      <fontColor>FFFFFF</fontColor>
      <fontBold>true</fontBold>
      <hAlign>left</hAlign>
    </control>
  </controls>
  <taskSet count="2">
    <taskSetItem name="login">
      <script1>g5.username = ee.getEditText(ee.getControl("edit1"));
g5.password = ee.getEditText(ee.getControl("edit2"));
if (g5.username.length!=11) {
    alert("请输入有效的手机号码");
    return;
}
eio.appendString8(g5.username);
eio.appendString8(g5.password);

</script1>
      <script2>var username = eio.readString8();
var password = eio.readString8();
var passwordMd5 = es.getMd5(password);
var sql,sqlResult;  

sql="select*from userInfo where mobile='" + db.encode(username) +"'";                   
sqlResult = db.executeQuery("PJ", sql);  
db.read(sqlResult);
var userT=db.getString(sqlResult,"userType");  
var applyS=db.getString(sqlResult,"autoStatus");  
var passwordL=db.getString(sqlResult,"password");  
es.logWarning(sql);
es.logWarning(userT);
es.logWarning(applyS);
es.logWarning(passwordL);
es.logWarning(passwordMd5);
/*if(userT=="教练"&amp;&amp;applyS=="CNN"&amp;&amp;passwordL==passwordMd5){      
    eio.appendString8("T1"); 
    session.set("mobile", username) 
    return;
}*/  
es.logWarning(userT);
sql = "exec loginDrp '" + db.encode(username) + "'," +
    "'" + passwordMd5 + "'";
sqlResult = db.executeQuery("PJ", sql);
es.logWarning(sql);
if (sqlResult == null) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode")!=0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    es.logCommon("用户登录失败,username=" + username + ",password=" + password);
    return;
} 
eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));
es.logCommon("用户登录：" + username);
</script2>
      <script3>var resultCode=eio.readString8(); 
if (resultCode=="F") {
    alert("登录失败：" + eio.readString8());
    g5.show(1);
    return;
}  

/*if (resultCode=="T1") {
    window.location.href=ee.pageRoot + "/main";
    return;
} */

//获取令牌
eb.setCookie("pjToken", eio.readString8());  
loginToken();



</script3>
    </taskSetItem>
    <taskSetItem name="loginToken">
      <script1>g5.token = eb.getCookie("pjToken");
if (eb.isEmpty(g5.token)) {
    //g5.show(1);
    return;              
}
eio.appendString8(g5.token);
</script1>
      <script2><![CDATA[var token = eio.readString8();
var sql,sqlResult;
sql = "exec getUserInfoBySession '" + db.encode(token) + "'";
sqlResult = db.executeQuery("PJ", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("上次登录时间太久或者您更换了系统");
    es.logCommon("用户token登录失败,token=" + token);
    return;
} 
eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "userType"));
es.logCommon("用户token登录,nickName=" + db.getString(sqlResult,"nickName")+
    ",mobile=" + db.getString(sqlResult, "mobile"));

]]></script2>
      <script3>if (eio.readString8()!="T") {
    alert("登录失败："+eio.readString8());
    //g5.show(1);
    return;
}
var userType = eio.readString8();
eb.setCookie("pjUserType", userType);
window.location.href=ee.pageRoot + "/main";  
//window.location.href="http://m.1peijia.com:88/EEngine/ee.aspx?_L_=/App1PJAdmin/login"
/*if (userType=="教练") {                   
    window.location.href = ee.pageRoot + "/cMain"; 
} else {
    window.location.href = ee.pageRoot + "/student/sMain"; 
} */


</script3>
    </taskSetItem>
  </taskSet>
  <gridLines count="0" />
</page>