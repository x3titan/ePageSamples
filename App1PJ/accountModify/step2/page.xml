<page>
  <controls count="54">
    <control type="DivRoot" pathname="/divRoot">
      <left>0</left>
      <top>0</top>
      <width>581</width>
      <height>819</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>F3F3F3</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <backgroundImg>xz_bn.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <onControlLoad>var isIOS = !!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
if (!isIOS) {
    ee.getControl("layoutyitem1").heavy = 0;
}
//设置文件上传进度条
g5.setProgress = function (percent) {
    var c = ee.getControl("panel27");
    ee.setRect(c,null,null,parseInt(eb.getDivRect(c.parentNode).w*percent),null);
    ee.setText(ee.getControl("panel23"),
        "文件正在上传中，请耐心等候...\r\n" + parseInt(percent*100) + "%");    
}
g5.photo2 = "";
g5.photo3 = ""; 

g5.onDeviceReady = function () {
    g5.initUpload("fileupload1");
    g5.initUpload("fileupload2");
}
document.addEventListener("deviceready", g5.onDeviceReady, false);

g5.initUpload = function (controlName) {
    var cc = ee.getControl(controlName);
    if (eb.isEmpty(cc)) return;
    var isIOS = !!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
    if (isIOS) return;
    eval(
        "cc.onclick = function () {\n"+
        "    g5.currentUploadName='" + controlName + "';\n"+
        "    g5.openFileSelector();\n"+
        "}\n"
    ); 
    g5.pgFileTransfer = null;    
    g5.openFileSelector = function() {
        var source = navigator.camera.PictureSourceType.PHOTOLIBRARY;
        //描述类型，取文件路径
        var destinationType = navigator.camera.DestinationType.FILE_URI;
        //媒体类型，设置为ALLMEDIA即支持任意文件选择
        var mediaType = navigator.camera.MediaType.ALLMEDIA;
        var options={
        quality : 50,
        destinationType : destinationType,
        sourceType : source,
        mediaType : mediaType    
        };
        navigator.camera.getPicture(g5.uploadFile,g5.uploadBroken,options);
    };
    //上传意外终止处理。
    g5.uploadBroken = function(message){
      alert(message);
      g5.pgFileTransfer.abort();
    };
    //上传过程回调，用于处理上传进度，如显示进度条等。
    g5.uploadProcessing = function(progressEvent){
      if (progressEvent.lengthComputable) {
        //已经上传
        var loaded=progressEvent.loaded;
        //文件总长度
        var total=progressEvent.total;
        //计算百分比，用于显示进度条
        var percent=parseInt((loaded/total)*100);
        //换算成MB
        loaded=(loaded/1024/1024).toFixed(2);
        total=(total/1024/1024).toFixed(2);
        $('#process_info').html(loaded+'/'+total);
        $('.upload_current_process').css({'width':percent+'%'});
      }
    };
    
    //选择文件后回调上传。
    g5.uploadFile = function(fileURI) {
      var options = new FileUploadOptions();
      options.fileKey = "file";
      options.fileName = fileURI.substr(fileURI.lastIndexOf('/') + 1);
      options.mimeType = "multipart/form-data";
      options.chunkedMode = false;
      g5.pgFileTransfer = new FileTransfer();
      eio.clear();
      //eio.appendString8(options.fileName);
      var uploadUrl=encodeURI("http://m.1peijia.com:88/eengine/ee.aspx?_L_=/App1PJ/accountModify&amp;_F_=U&amp;controlName="+g5.currentUploadName+"&amp;eio="+eio.buffo);
      g5.pgFileTransfer.upload(fileURI,uploadUrl,g5.uploadSuccess, g5.uploadFailed, options);
      //获取上传进度
      g5.pgFileTransfer.onprogress = g5.uploadProcessing;
      //显示进度条
      //$('.upload_process_bar').show();
      eval(g5.currentUploadName+"_start()");
    } 
    //上传成功回调.
    g5.uploadSuccess = function(r) {
      //alert('文件上传成功:'+r.response);
      g5.pgFileTransfer.abort();
    }
    //上传失败回调.
    g5.uploadFailed = function(error) {
      alert('上传失败了。');
      g5.pgFileTransfer.abort();
    }

}

setTimeout(function(){
    ee.autoResize = false;
},1000);
</onControlLoad>
      <pageHead><![CDATA[<meta name="viewport" content="width=device-width, minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<script type="text/javascript" charset="utf-8" src="scripts/cordova-2.0.0.js"></script>
]]></pageHead>
    </control>
    <control type="Panel" pathname="/divRoot/panel4">
      <left>0</left>
      <top>89</top>
      <width>581</width>
      <height>80</height>
      <topRatio>0.108669108669109</topRatio>
      <widthRatio>1</widthRatio>
      <heightRatio>0.0976800976800977</heightRatio>
      <sizeRatio>0.137221269296741</sizeRatio>
      <dockX>fill</dockX>
      <dockY>ratio</dockY>
      <backgroundColor>FFFFFF</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <fontSizeAuto>30</fontSizeAuto>
      <layerVisible>false</layerVisible>
    </control>
    <control type="Panel" pathname="/divRoot/panel4/panel28">
      <left>71</left>
      <top>0</top>
      <width>438</width>
      <height>80</height>
      <leftRatio>0.121399176954733</leftRatio>
      <widthRatio>0.753086419753086</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.218579234972678</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>fill</dockY>
      <backgroundImg>step2.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
    </control>
    <control type="Panel" pathname="/divRoot/panel2">
      <left>12</left>
      <top>176</top>
      <width>555</width>
      <height>565</height>
      <leftRatio>0.0205831903945112</leftRatio>
      <topRatio>0.214896214896215</topRatio>
      <widthRatio>0.955403087478559</widthRatio>
      <heightRatio>0.68986568986569</heightRatio>
      <sizeRatio>1.01436265709156</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>body5</backgroundSkin>
      <fontSizeAuto>30</fontSizeAuto>
      <layerVisible>false</layerVisible>
    </control>
    <control type="LayoutX" pathname="/divRoot/panel2/layoutx1">
      <left>29</left>
      <top>301</top>
      <width>497</width>
      <height>33</height>
      <leftRatio>0.0523809523809524</leftRatio>
      <topRatio>0.532289628180039</topRatio>
      <widthRatio>0.895238095238095</widthRatio>
      <heightRatio>0.0587084148727984</heightRatio>
      <sizeRatio>0.0797872340425532</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx1/layoutxitem1">
      <left>0</left>
      <top>0</top>
      <width>166</width>
      <height>33</height>
      <widthRatio>0.332665330661323</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.198795180722892</sizeRatio>
      <backgroundColor>f0f0f0</backgroundColor>
      <text>车牌：</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>right</hAlign>
      <heavy>50</heavy>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx1/layoutxitem2">
      <left>166</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <leftRatio>0.332665330661323</leftRatio>
      <widthRatio>0.667334669338677</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <backgroundColor>d0d0d0</backgroundColor>
    </control>
    <control type="Edit" pathname="/divRoot/panel2/layoutx1/layoutxitem2/edit1">
      <left>0</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundSkin>line3</backgroundSkin>
      <inputFontSizeAuto>30</inputFontSizeAuto>
    </control>
    <control type="LayoutX" pathname="/divRoot/panel2/layoutx4">
      <left>29</left>
      <top>347</top>
      <width>497</width>
      <height>33</height>
      <leftRatio>0.0523809523809524</leftRatio>
      <topRatio>0.614481409001957</topRatio>
      <widthRatio>0.895238095238095</widthRatio>
      <heightRatio>0.0587084148727984</heightRatio>
      <sizeRatio>0.0797872340425532</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx4/layoutxitem7">
      <left>0</left>
      <top>0</top>
      <width>166</width>
      <height>33</height>
      <widthRatio>0.332665330661323</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.198795180722892</sizeRatio>
      <backgroundColor>f0f0f0</backgroundColor>
      <text>车型：</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>right</hAlign>
      <heavy>50</heavy>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx4/layoutxitem8">
      <left>166</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <leftRatio>0.332665330661323</leftRatio>
      <widthRatio>0.667334669338677</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <backgroundColor>d0d0d0</backgroundColor>
    </control>
    <control type="Edit" pathname="/divRoot/panel2/layoutx4/layoutxitem8/edit2">
      <left>0</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundSkin>line3</backgroundSkin>
      <inputFontSizeAuto>30</inputFontSizeAuto>
    </control>
    <control type="LayoutX" pathname="/divRoot/panel2/layoutx5">
      <left>29</left>
      <top>394</top>
      <width>497</width>
      <height>33</height>
      <leftRatio>0.0523809523809524</leftRatio>
      <topRatio>0.696673189823875</topRatio>
      <widthRatio>0.895238095238095</widthRatio>
      <heightRatio>0.0587084148727984</heightRatio>
      <sizeRatio>0.0797872340425532</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx5/layoutxitem9">
      <left>0</left>
      <top>0</top>
      <width>166</width>
      <height>33</height>
      <widthRatio>0.332665330661323</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.198795180722892</sizeRatio>
      <backgroundColor>f0f0f0</backgroundColor>
      <text>初次领证年：</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>right</hAlign>
      <heavy>50</heavy>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx5/layoutxitem10">
      <left>166</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <leftRatio>0.332665330661323</leftRatio>
      <widthRatio>0.667334669338677</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <backgroundColor>d0d0d0</backgroundColor>
    </control>
    <control type="Edit" pathname="/divRoot/panel2/layoutx5/layoutxitem10/edit3">
      <left>0</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundSkin>line3</backgroundSkin>
      <inputText>2003</inputText>
      <inputFontSizeAuto>30</inputFontSizeAuto>
    </control>
    <control type="LayoutX" pathname="/divRoot/panel2/layoutx6">
      <left>29</left>
      <top>440</top>
      <width>497</width>
      <height>33</height>
      <leftRatio>0.0523809523809524</leftRatio>
      <topRatio>0.778864970645793</topRatio>
      <widthRatio>0.895238095238095</widthRatio>
      <heightRatio>0.0587084148727984</heightRatio>
      <sizeRatio>0.0797872340425532</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx6/layoutxitem11">
      <left>0</left>
      <top>0</top>
      <width>166</width>
      <height>33</height>
      <widthRatio>0.332665330661323</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.198795180722892</sizeRatio>
      <backgroundColor>f0f0f0</backgroundColor>
      <text>陪驾受理区域：</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>right</hAlign>
      <heavy>50</heavy>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx6/layoutxitem12">
      <left>166</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <leftRatio>0.332665330661323</leftRatio>
      <widthRatio>0.667334669338677</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <backgroundColor>d0d0d0</backgroundColor>
    </control>
    <control type="Edit" pathname="/divRoot/panel2/layoutx6/layoutxitem12/edit4">
      <left>0</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundSkin>line3</backgroundSkin>
      <inputFontSizeAuto>30</inputFontSizeAuto>
    </control>
    <control type="LayoutX" pathname="/divRoot/panel2/layoutx2">
      <left>29</left>
      <top>486</top>
      <width>497</width>
      <height>33</height>
      <leftRatio>0.0523809523809524</leftRatio>
      <topRatio>0.86105675146771</topRatio>
      <widthRatio>0.895238095238095</widthRatio>
      <heightRatio>0.0587084148727984</heightRatio>
      <sizeRatio>0.0797872340425532</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx2/layoutxitem3">
      <left>0</left>
      <top>0</top>
      <width>166</width>
      <height>33</height>
      <widthRatio>0.332665330661323</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.198795180722892</sizeRatio>
      <backgroundColor>f0f0f0</backgroundColor>
      <text>驾照号码：</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>right</hAlign>
      <heavy>50</heavy>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel2/layoutx2/layoutxitem4">
      <left>166</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <leftRatio>0.332665330661323</leftRatio>
      <widthRatio>0.667334669338677</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <backgroundColor>d0d0d0</backgroundColor>
    </control>
    <control type="Edit" pathname="/divRoot/panel2/layoutx2/layoutxitem4/edit5">
      <left>0</left>
      <top>0</top>
      <width>331</width>
      <height>33</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0990990990990991</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundSkin>line3</backgroundSkin>
      <inputFontSizeAuto>30</inputFontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel2/panel8">
      <left>20</left>
      <top>37</top>
      <width>252</width>
      <height>224</height>
      <leftRatio>0.0366379310344828</leftRatio>
      <topRatio>0.0652920962199313</topRatio>
      <widthRatio>0.454741379310345</widthRatio>
      <heightRatio>0.396907216494845</heightRatio>
      <sizeRatio>1.09478672985782</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>line3</backgroundSkin>
      <fontSizeAuto>30</fontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel2/panel8/panel5">
      <left>13</left>
      <top>7</top>
      <width>225</width>
      <height>141</height>
      <leftRatio>0.0526315789473684</leftRatio>
      <topRatio>0.0307017543859649</topRatio>
      <widthRatio>0.894736842105263</widthRatio>
      <heightRatio>0.631578947368421</heightRatio>
      <sizeRatio>0.941176470588235</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundImg>CPY0001.jpg</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
    </control>
    <control type="Panel" pathname="/divRoot/panel2/panel8/panel6">
      <left>14</left>
      <top>168</top>
      <width>226</width>
      <height>43</height>
      <leftRatio>0.0568720379146919</leftRatio>
      <topRatio>0.748917748917749</topRatio>
      <widthRatio>0.895734597156398</widthRatio>
      <heightRatio>0.19047619047619</heightRatio>
      <sizeRatio>0.232804232804233</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>上传驾驶证</text>
      <fontSizeAuto>25</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <cursor>pointer</cursor>
    </control>
    <control type="FileUpload" pathname="/divRoot/panel2/panel8/panel6/fileupload1">
      <left>0</left>
      <top>0</top>
      <width>226</width>
      <height>43</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.18942731277533</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <bgColorEnabled>true</bgColorEnabled>
      <alpha>0.98</alpha>
      <onUploadStartC>//初步过滤
fileExt = fileExt.toUpperCase();
if ((fileExt!=".JPG")&amp;&amp;(fileExt!=".BMP")&amp;&amp;(fileExt!=".PNG")) {
    alert("对不起，请务必选择一张有效的图片");
    return;
}
ee.showAni(ee.getControl("panel21"));
g5.setProgress(0.06);
g5.uploadControl = ee.getControl("fileupload1");
</onUploadStartC>
      <onUploadStartS><![CDATA[//产生文件名
var sql = 
    "declare @r varchar(20); " +
    "exec @r = getPhotoName; " +
    "select @r as result;";
var sqlResult = db.executeQuery("PJ", sql);
if (fileExt.length<=0) {
    fileExt = ".jpg";
}
while (true) {
    if (sqlResult == null) {
        cancelUpload = true;
        errorString = "系统繁忙，请稍后再试";
        break;
    }
    db.read(sqlResult);
    newFileName = db.getString(sqlResult, "result") + fileExt.toLowerCase();
    newFileName = "E:\\www\\root\\userRes\\" + newFileName;
    break;
}
]]></onUploadStartS>
      <onUploadProgress>g5.setProgress(sizeCurrent/sizeTotal);

</onUploadProgress>
      <onUploadError>alert("上传文件失败："+errorString);
ee.setVisible(ee.getControl("panel21"), false);


          
</onUploadError>
      <onUploadCompleteC>g5.photo2 = eio.readString8();
eb.setCookie("am_photo2", g5.photo2);
ee.setImage(ee.getControl("panel5"), "url:/userRes/" +g5.photo2, "trim");   
ee.setVisible(ee.getControl("panel21"), false);

</onUploadCompleteC>
      <onUploadCompleteS>//取文件名
var pos=newFileName.lastIndexOf("\\");
var filename = newFileName.substring(pos+1);
//写入session供后续或者页面掉线后使用
session.set("photo1", filename);
es.logWarning(filename);
eio.appendString8(filename);  
</onUploadCompleteS>
    </control>
    <control type="Panel" pathname="/divRoot/panel2/panel10">
      <left>282</left>
      <top>37</top>
      <width>252</width>
      <height>224</height>
      <leftRatio>0.508620689655172</leftRatio>
      <topRatio>0.0652920962199313</topRatio>
      <widthRatio>0.454741379310345</widthRatio>
      <heightRatio>0.396907216494845</heightRatio>
      <sizeRatio>1.09478672985782</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>line3</backgroundSkin>
      <fontSizeAuto>30</fontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel2/panel10/panel11">
      <left>13</left>
      <top>7</top>
      <width>226</width>
      <height>141</height>
      <leftRatio>0.0523560209424084</leftRatio>
      <topRatio>0.0295566502463054</topRatio>
      <widthRatio>0.895287958115183</widthRatio>
      <heightRatio>0.630541871921182</heightRatio>
      <sizeRatio>0.748538011695906</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundImg>CPY0002.jpg</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
    </control>
    <control type="Panel" pathname="/divRoot/panel2/panel10/panel12">
      <left>14</left>
      <top>168</top>
      <width>226</width>
      <height>43</height>
      <leftRatio>0.0568720379146919</leftRatio>
      <topRatio>0.748917748917749</topRatio>
      <widthRatio>0.895734597156398</widthRatio>
      <heightRatio>0.19047619047619</heightRatio>
      <sizeRatio>0.232804232804233</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>上传行驶证</text>
      <fontSizeAuto>25</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <cursor>pointer</cursor>
    </control>
    <control type="FileUpload" pathname="/divRoot/panel2/panel10/panel12/fileupload2">
      <left>0</left>
      <top>0</top>
      <width>226</width>
      <height>43</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.18942731277533</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <bgColorEnabled>true</bgColorEnabled>
      <alpha>0.98</alpha>
      <onUploadStartC>//初步过滤
fileExt = fileExt.toUpperCase();
if ((fileExt!=".JPG")&amp;&amp;(fileExt!=".BMP")&amp;&amp;(fileExt!=".PNG")) {
    alert("对不起，请务必选择一张有效的图片");
    return;
}
ee.showAni(ee.getControl("panel21"));
g5.setProgress(0.06);
g5.uploadControl = ee.getControl("fileupload2");
</onUploadStartC>
      <onUploadStartS><![CDATA[//产生文件名
var sql = 
    "declare @r varchar(20); " +
    "exec @r = getPhotoName; " +
    "select @r as result;";
var sqlResult = db.executeQuery("PJ", sql);
if (fileExt.length<=0) {
    fileExt = ".jpg";
}
while (true) {
    if (sqlResult == null) {
        cancelUpload = true;
        errorString = "系统繁忙，请稍后再试";
        break;
    }
    db.read(sqlResult);
    newFileName = db.getString(sqlResult, "result") + fileExt.toLowerCase();
    newFileName = "E:\\www\\root\\userRes\\" + newFileName;
    break;
}
]]></onUploadStartS>
      <onUploadProgress>g5.setProgress(sizeCurrent/sizeTotal);

</onUploadProgress>
      <onUploadError>alert("上传文件失败："+errorString);
ee.setVisible(ee.getControl("panel21"), false);


          
</onUploadError>
      <onUploadCompleteC>g5.photo3 = eio.readString8();
eb.setCookie("am_photo3", g5.photo3);
ee.setImage(ee.getControl("panel11"), "url:/userRes/" +g5.photo3, "trim");   
ee.setVisible(ee.getControl("panel21"), false);

</onUploadCompleteC>
      <onUploadCompleteS>//取文件名
var pos=newFileName.lastIndexOf("\\");
var filename = newFileName.substring(pos+1);
//写入session供后续或者页面掉线后使用
session.set("photo1", filename);
es.logWarning(filename);
eio.appendString8(filename);  
</onUploadCompleteS>
    </control>
    <control type="Panel" pathname="/divRoot/panel3">
      <left>116</left>
      <top>751</top>
      <width>349</width>
      <height>52</height>
      <leftRatio>0.198970840480274</leftRatio>
      <topRatio>0.916971916971917</topRatio>
      <widthRatio>0.600343053173242</widthRatio>
      <heightRatio>0.0634920634920635</heightRatio>
      <sizeRatio>0.148571428571429</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>提交审核</text>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <layerVisible>false</layerVisible>
      <cursor>pointer</cursor>
      <onClick><![CDATA[//客户端验证
var value;
value = ee.getEditText(ee.getControl("edit1"));
if ((value.length<0)||(value.length>7)) {
    alert("请输入您所拥有的真实有效的车牌号码如：沪F22334，没有车的可以不填");
    return;
}
value = ee.getEditText(ee.getControl("edit3"));
g5.licenseStart = parseInt(value);
if (isNaN(g5.licenseStart)) {
    alert("请输入您驾驶证初次领证的年份，如：2001");
    return;
}
if ((g5.licenseStart<1980)||(g5.licenseStart>2050)) {
    alert("请输入您驾驶证初次领证的年份，如：2001");
    return;
}
value = ee.getEditText(ee.getControl("edit5"));
if (value.length<8) {
    alert("请输入您真实有效的驾照号码");
    return;
}

if (eb.getCookie("am_photo2")==null) {
    alert("请选择并上传本人的驾驶证");
    return;
} 

ee.showAni(ee.getControl("panel20"));

 ]]></onClick>
    </control>
    <control type="Panel" pathname="/divRoot/panel18">
      <left>0</left>
      <top>0</top>
      <width>581</width>
      <height>819</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>1.40480274442539</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>000000</backgroundColor>
      <backgroundImg>dialogMask.png</backgroundImg>
      <backgroundImgMode>stretch</backgroundImgMode>
      <layerName>m2</layerName>
      <layerVisible>false</layerVisible>
      <aniAlpha>whiteAlpha:白色淡出</aniAlpha>
    </control>
    <control type="Panel" pathname="/divRoot/panel18/panel16">
      <left>32</left>
      <top>154</top>
      <width>514</width>
      <height>289</height>
      <leftRatio>0.0545454545454545</leftRatio>
      <topRatio>0.187760778859527</topRatio>
      <widthRatio>0.884090909090909</widthRatio>
      <heightRatio>0.35326842837274</heightRatio>
      <sizeRatio>0.652956298200514</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>body2</backgroundSkin>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
    </control>
    <control type="Panel" pathname="/divRoot/panel18/panel16/panel17">
      <left>18</left>
      <top>15</top>
      <width>480</width>
      <height>189</height>
      <leftRatio>0.0359897172236504</leftRatio>
      <topRatio>0.0511811023622047</topRatio>
      <widthRatio>0.933161953727506</widthRatio>
      <heightRatio>0.653543307086614</heightRatio>
      <sizeRatio>0.457300275482094</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>line1001</backgroundSkin>
      <text>　　感谢您对我们工作的信任和支持，我们的后台工作人员会在1-3个工作日内对您信息的真实性进行核实。审核通过后您将成为1陪驾的认证教练，正式开启您在1陪驾的教练之路。
　　愿我们共同发展！

　　　　　　　　　　　　　　　-- １陪驾运营团队</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel18/panel16/panel19">
      <left>53</left>
      <top>215</top>
      <width>405</width>
      <height>46</height>
      <leftRatio>0.102325581395349</leftRatio>
      <topRatio>0.743944636678201</topRatio>
      <widthRatio>0.788372093023256</widthRatio>
      <heightRatio>0.15916955017301</heightRatio>
      <sizeRatio>0.135693215339233</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>确 定</text>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <cursor>pointer</cursor>
      <onClick>window.location.href = ee.pageRoot + "/cMain";

                                                   </onClick>
    </control>
    <control type="Panel" pathname="/divRoot/panel20">
      <left>0</left>
      <top>0</top>
      <width>581</width>
      <height>819</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>1.40480274442539</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>000000</backgroundColor>
      <backgroundImg>dialogMask.png</backgroundImg>
      <backgroundImgMode>stretch</backgroundImgMode>
      <layerName>m1</layerName>
      <layerVisible>false</layerVisible>
      <aniAlpha>whiteAlpha:白色淡出</aniAlpha>
    </control>
    <control type="Panel" pathname="/divRoot/panel20/panel13">
      <left>32</left>
      <top>153</top>
      <width>514</width>
      <height>289</height>
      <leftRatio>0.0545454545454545</leftRatio>
      <topRatio>0.186369958275382</topRatio>
      <widthRatio>0.884090909090909</widthRatio>
      <heightRatio>0.35326842837274</heightRatio>
      <sizeRatio>0.652956298200514</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>body2</backgroundSkin>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
    </control>
    <control type="Panel" pathname="/divRoot/panel20/panel13/panel14">
      <left>18</left>
      <top>15</top>
      <width>480</width>
      <height>115</height>
      <leftRatio>0.0359897172236504</leftRatio>
      <topRatio>0.0526315789473684</topRatio>
      <widthRatio>0.933161953727506</widthRatio>
      <heightRatio>0.399122807017544</heightRatio>
      <sizeRatio>0.25068870523416</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>line1001</backgroundSkin>
      <text>　　恭喜您的信息填写完整，您是否确认要将这些信息提交给我们的后台工作人员进行进一步的审核？</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel20/panel13/panel15">
      <left>53</left>
      <top>157</top>
      <width>405</width>
      <height>46</height>
      <leftRatio>0.102325581395349</leftRatio>
      <topRatio>0.543252595155709</topRatio>
      <widthRatio>0.788372093023256</widthRatio>
      <heightRatio>0.15916955017301</heightRatio>
      <sizeRatio>0.135693215339233</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>不，我还有信息要修改</text>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <cursor>pointer</cursor>
      <onClick>ee.setVisible(ee.getControl("panel20"), false);


                                                   </onClick>
    </control>
    <control type="Panel" pathname="/divRoot/panel20/panel13/panel7">
      <left>54</left>
      <top>217</top>
      <width>405</width>
      <height>46</height>
      <leftRatio>0.104651162790698</leftRatio>
      <topRatio>0.750865051903114</topRatio>
      <widthRatio>0.788372093023256</widthRatio>
      <heightRatio>0.15916955017301</heightRatio>
      <sizeRatio>0.135693215339233</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>是的，我要提交审核</text>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <cursor>pointer</cursor>
      <onClick>modifyUserInfo();</onClick>
    </control>
    <control type="Panel" pathname="/divRoot/panel21">
      <left>0</left>
      <top>0</top>
      <width>581</width>
      <height>819</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>1.40480274442539</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>000000</backgroundColor>
      <backgroundImg>dialogMask.png</backgroundImg>
      <backgroundImgMode>stretch</backgroundImgMode>
      <layerName>m3</layerName>
      <layerVisible>false</layerVisible>
      <aniAlpha>whiteAlpha:白色淡出</aniAlpha>
    </control>
    <control type="Panel" pathname="/divRoot/panel21/panel22">
      <left>31</left>
      <top>154</top>
      <width>513</width>
      <height>289</height>
      <leftRatio>0.0539956803455724</leftRatio>
      <topRatio>0.187760778859527</topRatio>
      <widthRatio>0.883369330453564</widthRatio>
      <heightRatio>0.35326842837274</heightRatio>
      <sizeRatio>0.621026894865526</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>body2</backgroundSkin>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
    </control>
    <control type="Panel" pathname="/divRoot/panel21/panel22/panel23">
      <left>16</left>
      <top>20</top>
      <width>479</width>
      <height>86</height>
      <leftRatio>0.0317848410757946</leftRatio>
      <topRatio>0.0708661417322835</topRatio>
      <widthRatio>0.93398533007335</widthRatio>
      <heightRatio>0.299212598425197</heightRatio>
      <sizeRatio>0.198952879581152</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>line1001</backgroundSkin>
      <text>文件正在上传中，请耐心等候</text>
      <fontSizeAuto>30</fontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel21/panel22/panel24">
      <left>53</left>
      <top>215</top>
      <width>405</width>
      <height>46</height>
      <leftRatio>0.102564102564103</leftRatio>
      <topRatio>0.743944636678201</topRatio>
      <widthRatio>0.79020979020979</widthRatio>
      <heightRatio>0.15916955017301</heightRatio>
      <sizeRatio>0.135693215339233</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>取消上传</text>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <cursor>pointer</cursor>
      <onClick>g5.uploadControl.stop();
ee.setVisible(ee.getControl("panel21"), false);


                                                   </onClick>
    </control>
    <control type="Panel" pathname="/divRoot/panel21/panel22/panel25">
      <left>16</left>
      <top>134</top>
      <width>479</width>
      <height>25</height>
      <leftRatio>0.0317848410757946</leftRatio>
      <topRatio>0.464566929133858</topRatio>
      <widthRatio>0.93398533007335</widthRatio>
      <heightRatio>0.0866141732283465</heightRatio>
      <sizeRatio>0.0575916230366492</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>line1001</backgroundSkin>
      <fontSizeAuto>30</fontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel21/panel22/panel25/panel26">
      <left>5</left>
      <top>5</top>
      <width>469</width>
      <height>15</height>
      <leftRatio>0.0103950103950104</leftRatio>
      <topRatio>0.2</topRatio>
      <widthRatio>0.979209979209979</widthRatio>
      <heightRatio>0.6</heightRatio>
      <sizeRatio>0.0318471337579618</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <outerLeft>5</outerLeft>
      <outerRight>5</outerRight>
      <outerTop>5</outerTop>
      <outerBottom>5</outerBottom>
      <backgroundColor>E0E0E0</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <fontSizeAuto>30</fontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel21/panel22/panel25/panel26/panel27">
      <left>0</left>
      <top>0</top>
      <width>141</width>
      <height>15</height>
      <widthRatio>0.299363057324841</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.106382978723404</sizeRatio>
      <dockX>left</dockX>
      <dockY>fill</dockY>
      <backgroundColor>008080</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <fontSizeAuto>30</fontSizeAuto>
      <layerVisible>false</layerVisible>
    </control>
    <control type="LayoutY" pathname="/divRoot/layouty1">
      <left>0</left>
      <top>0</top>
      <width>581</width>
      <height>90</height>
      <widthRatio>1</widthRatio>
      <heightRatio>0.10989010989011</heightRatio>
      <sizeRatio>0.154373927958834</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem1">
      <left>0</left>
      <top>0</top>
      <width>581</width>
      <height>29</height>
      <widthRatio>1</widthRatio>
      <heightRatio>0.322222222222222</heightRatio>
      <sizeRatio>0.0497427101200686</sizeRatio>
      <backgroundColor>BFCEDF</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <heavy>47</heavy>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem2">
      <left>0</left>
      <top>29</top>
      <width>581</width>
      <height>61</height>
      <topRatio>0.322222222222222</topRatio>
      <widthRatio>1</widthRatio>
      <heightRatio>0.677777777777778</heightRatio>
      <sizeRatio>0.104631217838765</sizeRatio>
      <backgroundColor>47A9F9</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <text>个人信息认证</text>
      <fontSizeAuto>15</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel29">
      <left>16</left>
      <top>13</top>
      <width>69</width>
      <height>34</height>
      <leftRatio>0.0274442538593482</leftRatio>
      <topRatio>0.213114754098361</topRatio>
      <widthRatio>0.118353344768439</widthRatio>
      <heightRatio>0.557377049180328</heightRatio>
      <sizeRatio>0.492753623188406</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundImg>back.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <fontSizeAuto>30</fontSizeAuto>
      <cursor>pointer</cursor>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel30">
      <left>1</left>
      <top>1</top>
      <width>114</width>
      <height>57</height>
      <leftRatio>0.00171526586620926</leftRatio>
      <topRatio>0.0163934426229508</topRatio>
      <widthRatio>0.195540308747856</widthRatio>
      <heightRatio>0.934426229508197</heightRatio>
      <sizeRatio>0.5</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>empty</backgroundSkin>
      <onClick>window.location.href = ee.pageRoot + "/accountModify";
</onClick>
    </control>
  </controls>
  <taskSet count="1">
    <taskSetItem name="modifyUserInfo">
      <script1>eio.appendString8(eb.getCookie("pjToken"));
eio.appendString8(eb.getCookie("am_photo1"));
eio.appendString8(eb.getCookie("am_name"));
eio.appendString8(eb.getCookie("am_id"));
eio.appendString8(eb.getCookie("am_addr"));
eio.appendString8(eb.getCookie("am_emName"));
eio.appendString8(eb.getCookie("am_emTel"));
eio.appendString8(g5.photo2);
eio.appendString8(g5.photo3);
eio.appendString8(ee.getEditText(ee.getControl("edit1")));
eio.appendString8(ee.getEditText(ee.getControl("edit2")));
eio.appendInt32(g5.licenseStart);
eio.appendString8(ee.getEditText(ee.getControl("edit4")));
eio.appendString8(ee.getEditText(ee.getControl("edit5")));

</script1>
      <script2><![CDATA[var token = eio.readString8();
var sql,sqlResult;
sql = "exec getUserInfoBySession '" + db.encode(token) + "'";
sqlResult = db.executeQuery("PJ", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("token失效");
    es.logWarning("用户token失效, sql=" + sql);
    return;
} 
var userId = db.getString(sqlResult, "id");

var photo1 = eio.readString8();
var userName = eio.readString8();
var userId = eio.readString8();
var userAddr = eio.readString8();
var emName = eio.readString8();
var emTel = eio.readString8();
var photo2 = eio.readString8();
var photo3 = eio.readString8();
var carId = eio.readString8();
var carType = eio.readString8();
var licenseStart = eio.readInt32();
var serviceArea = eio.readString8();
var licenseNumber = eio.readString8();
sql =
    "update userInfo set " +
    "authStatus = 'N', " +
    "photo1 = '" + db.encode(photo1) + "', " +
    "photo2 = '" + db.encode(photo2) + "', " +
    "photo3 = '" + db.encode(photo3) + "', " +
    "idName = '" + db.encode(userName) + "', " +
    "idNumber = '" + db.encode(userId) + "', " +
    "address = '" + db.encode(userAddr) + "', " +
    "emName = '" + db.encode(emName) + "', " +
    "emTel = '" + db.encode(emTel) + "', " +
    "carId = '" + db.encode(carId) + "', " +
    "carType = '" + db.encode(carType) + "', " +
    "licenseStart = " + licenseStart + ", " + 
    "serviceArea = '" + db.encode(serviceArea) + "', " +
    "licenseNumber = '" + db.encode(licenseNumber) + "' " +
    "where id = " + userId;
if (!db.executeNoneQuery("PJ", sql)) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}

eio.appendString8("T");

]]></script2>
      <script3>var resultCode = eio.readString8();
var resultString = eio.readString8();
if (resultCode!="T") {
    alert("提交个人资料失败：" + resultString);
    return;
}
ee.setVisible(ee.getControl("panel20"), false);
ee.showAni(ee.getControl("panel18"));
</script3>
    </taskSetItem>
  </taskSet>
  <gridLines count="0" />
</page>