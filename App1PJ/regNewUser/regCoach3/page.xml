<page>
  <controls count="27">
    <control type="DivRoot" pathname="/divRoot">
      <left>0</left>
      <top>0</top>
      <width>1369</width>
      <height>819</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>F3F3F3</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <onControlLoad>var isIOS = !!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
if (!isIOS) {
    ee.getControl("layoutyitem1").heavy = 0;
}
setTimeout(function(){
    ee.autoResize = false;
},1000);
</onControlLoad>
    </control>
    <control type="Panel" pathname="/divRoot/panel3">
      <left>50</left>
      <top>196</top>
      <width>1268</width>
      <height>483</height>
      <leftRatio>0.0368763557483731</leftRatio>
      <topRatio>0.239316239316239</topRatio>
      <widthRatio>0.926247288503254</widthRatio>
      <heightRatio>0.58974358974359</heightRatio>
      <sizeRatio>1.13114754098361</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundColor>FFFFFF</backgroundColor>
      <backgroundSkin>body5</backgroundSkin>
    </control>
    <control type="LayoutX" pathname="/divRoot/panel3/layoutx1">
      <left>163</left>
      <top>106</top>
      <width>944</width>
      <height>35</height>
      <leftRatio>0.128805620608899</leftRatio>
      <topRatio>0.219461697722567</topRatio>
      <widthRatio>0.744730679156909</widthRatio>
      <heightRatio>0.072463768115942</heightRatio>
      <sizeRatio>0.110062893081761</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel3/layoutx1/layoutxitem1">
      <left>0</left>
      <top>0</top>
      <width>270</width>
      <height>35</height>
      <widthRatio>0.28625</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.152838427947598</sizeRatio>
      <backgroundColor>f0f0f0</backgroundColor>
      <text>昵称：</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>right</hAlign>
      <heavy>80</heavy>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel3/layoutx1/layoutxitem2">
      <left>270</left>
      <top>0</top>
      <width>674</width>
      <height>35</height>
      <leftRatio>0.28625</leftRatio>
      <widthRatio>0.71375</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0612959719789842</sizeRatio>
      <backgroundColor>d0d0d0</backgroundColor>
      <heavy>200</heavy>
    </control>
    <control type="Edit" pathname="/divRoot/panel3/layoutx1/layoutxitem2/edit1">
      <left>0</left>
      <top>0</top>
      <width>674</width>
      <height>35</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0612959719789842</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundSkin>edit1</backgroundSkin>
      <inputFontSize>30</inputFontSize>
      <inputFontSizeAuto>30</inputFontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel3/panel5">
      <left>659</left>
      <top>173</top>
      <width>454</width>
      <height>39</height>
      <leftRatio>0.519480519480519</leftRatio>
      <topRatio>0.358178053830228</topRatio>
      <widthRatio>0.358070500927644</widthRatio>
      <heightRatio>0.0807453416149068</heightRatio>
      <sizeRatio>0.202072538860104</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>看看是否重名</text>
      <fontSizeAuto>30</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <cursor>pointer</cursor>
      <onClick>checkName();                                                         </onClick>
    </control>
    <control type="LayoutX" pathname="/divRoot/panel3/layoutx2">
      <left>160</left>
      <top>270</top>
      <width>944</width>
      <height>35</height>
      <leftRatio>0.126463700234192</leftRatio>
      <topRatio>0.559006211180124</topRatio>
      <widthRatio>0.744730679156909</widthRatio>
      <heightRatio>0.072463768115942</heightRatio>
      <sizeRatio>0.110062893081761</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel3/layoutx2/layoutxitem3">
      <left>0</left>
      <top>0</top>
      <width>270</width>
      <height>35</height>
      <widthRatio>0.28625</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.152838427947598</sizeRatio>
      <backgroundColor>f0f0f0</backgroundColor>
      <text>登录密码：</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>right</hAlign>
      <heavy>80</heavy>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel3/layoutx2/layoutxitem4">
      <left>270</left>
      <top>0</top>
      <width>674</width>
      <height>35</height>
      <leftRatio>0.28625</leftRatio>
      <widthRatio>0.71375</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0612959719789842</sizeRatio>
      <backgroundColor>d0d0d0</backgroundColor>
      <heavy>200</heavy>
    </control>
    <control type="Edit" pathname="/divRoot/panel3/layoutx2/layoutxitem4/edit2">
      <left>0</left>
      <top>0</top>
      <width>674</width>
      <height>35</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0612959719789842</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundSkin>edit1</backgroundSkin>
      <inputPassword>true</inputPassword>
      <inputFontSize>30</inputFontSize>
      <inputFontSizeAuto>30</inputFontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel3/panel6">
      <left>267</left>
      <top>150</top>
      <width>840</width>
      <height>19</height>
      <leftRatio>0.210772833723653</leftRatio>
      <topRatio>0.31055900621118</topRatio>
      <widthRatio>0.662763466042155</widthRatio>
      <heightRatio>0.0393374741200828</heightRatio>
      <sizeRatio>0.0671378091872792</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <text>2-10个汉字或英文长度</text>
      <fontSizeAuto>40</fontSizeAuto>
      <hAlign>right</hAlign>
      <vAlign>top</vAlign>
    </control>
    <control type="LayoutX" pathname="/divRoot/panel3/layoutx3">
      <left>160</left>
      <top>315</top>
      <width>944</width>
      <height>35</height>
      <leftRatio>0.126463700234192</leftRatio>
      <topRatio>0.652173913043478</topRatio>
      <widthRatio>0.744730679156909</widthRatio>
      <heightRatio>0.072463768115942</heightRatio>
      <sizeRatio>0.110062893081761</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel3/layoutx3/layoutxitem5">
      <left>0</left>
      <top>0</top>
      <width>270</width>
      <height>35</height>
      <widthRatio>0.28625</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.152838427947598</sizeRatio>
      <backgroundColor>f0f0f0</backgroundColor>
      <text>重复密码：</text>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>right</hAlign>
      <heavy>80</heavy>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/panel3/layoutx3/layoutxitem6">
      <left>270</left>
      <top>0</top>
      <width>674</width>
      <height>35</height>
      <leftRatio>0.28625</leftRatio>
      <widthRatio>0.71375</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0612959719789842</sizeRatio>
      <backgroundColor>d0d0d0</backgroundColor>
      <heavy>200</heavy>
    </control>
    <control type="Edit" pathname="/divRoot/panel3/layoutx3/layoutxitem6/edit3">
      <left>0</left>
      <top>0</top>
      <width>674</width>
      <height>35</height>
      <widthRatio>1</widthRatio>
      <heightRatio>1</heightRatio>
      <sizeRatio>0.0612959719789842</sizeRatio>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundSkin>edit1</backgroundSkin>
      <inputPassword>true</inputPassword>
      <inputFontSize>30</inputFontSize>
      <inputFontSizeAuto>30</inputFontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel3/panel7">
      <left>77</left>
      <top>362</top>
      <width>1030</width>
      <height>31</height>
      <leftRatio>0.0608899297423888</leftRatio>
      <topRatio>0.749482401656315</topRatio>
      <widthRatio>0.812646370023419</widthRatio>
      <heightRatio>0.0641821946169772</heightRatio>
      <sizeRatio>0.0893371757925072</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <text>密码长度为6-15个英文字母，最好同时包含数字和英文字母</text>
      <fontSizeAuto>40</fontSizeAuto>
      <hAlign>right</hAlign>
      <vAlign>top</vAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel3/panel48">
      <left>62</left>
      <top>18</top>
      <width>615</width>
      <height>36</height>
      <leftRatio>0.0491803278688525</leftRatio>
      <topRatio>0.0372670807453416</topRatio>
      <widthRatio>0.484777517564403</widthRatio>
      <heightRatio>0.0745341614906832</heightRatio>
      <sizeRatio>0.173913043478261</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <text>账户基本信息卡片</text>
      <fontSizeAuto>30</fontSizeAuto>
      <fontColor>48A1DD</fontColor>
      <fontBold>true</fontBold>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel3/panel49">
      <left>59</left>
      <top>55</top>
      <width>1131</width>
      <height>2</height>
      <leftRatio>0.0468384074941452</leftRatio>
      <topRatio>0.113871635610766</topRatio>
      <widthRatio>0.892271662763466</widthRatio>
      <heightRatio>0.0041407867494824</heightRatio>
      <sizeRatio>0.005249343832021</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundColor>48A1DD</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
    </control>
    <control type="Panel" pathname="/divRoot/panel1">
      <left>294</left>
      <top>709</top>
      <width>742</width>
      <height>46</height>
      <leftRatio>0.214755295836377</leftRatio>
      <topRatio>0.865689865689866</topRatio>
      <widthRatio>0.54200146092038</widthRatio>
      <heightRatio>0.0561660561660562</heightRatio>
      <sizeRatio>0.0619946091644205</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>确定</text>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <cursor>pointer</cursor>
      <onClick>reg();  
</onClick>
    </control>
    <control type="Panel" pathname="/divRoot/panel4">
      <left>-2</left>
      <top>80</top>
      <width>1369</width>
      <height>107</height>
      <leftRatio>-0.00171821305841924</leftRatio>
      <topRatio>0.0976800976800977</topRatio>
      <widthRatio>1</widthRatio>
      <heightRatio>0.130647130647131</heightRatio>
      <sizeRatio>0.183848797250859</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundColor>FFFFFF</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <backgroundImgMode>fill</backgroundImgMode>
      <fontSizeAuto>30</fontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel4/panel10">
      <left>42</left>
      <top>23</top>
      <width>1310</width>
      <height>71</height>
      <leftRatio>0.0309278350515464</leftRatio>
      <topRatio>0.214953271028037</topRatio>
      <widthRatio>0.957044673539519</widthRatio>
      <heightRatio>0.663551401869159</heightRatio>
      <sizeRatio>0.127468581687612</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundImg>2.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <fontSizeAuto>30</fontSizeAuto>
    </control>
    <control type="LayoutY" pathname="/divRoot/layouty1">
      <left>0</left>
      <top>0</top>
      <width>1369</width>
      <height>90</height>
      <widthRatio>1</widthRatio>
      <heightRatio>0.10989010989011</heightRatio>
      <sizeRatio>0.154639175257732</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem1">
      <left>0</left>
      <top>0</top>
      <width>1369</width>
      <height>29</height>
      <widthRatio>1</widthRatio>
      <heightRatio>0.322222222222222</heightRatio>
      <sizeRatio>0.025</sizeRatio>
      <backgroundColor>BFCEDF</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <heavy>47</heavy>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem2">
      <left>0</left>
      <top>29</top>
      <width>1369</width>
      <height>61</height>
      <topRatio>0.322222222222222</topRatio>
      <widthRatio>1</widthRatio>
      <heightRatio>0.677777777777778</heightRatio>
      <sizeRatio>0.0525862068965517</sizeRatio>
      <backgroundColor>47A9F9</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <text>填写信息</text>
      <fontSizeAuto>15</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel8">
      <left>38</left>
      <top>13</top>
      <width>162</width>
      <height>34</height>
      <leftRatio>0.0274442538593482</leftRatio>
      <topRatio>0.213114754098361</topRatio>
      <widthRatio>0.118353344768439</widthRatio>
      <heightRatio>0.557377049180328</heightRatio>
      <sizeRatio>0.492753623188406</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundImg>back.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <fontSizeAuto>30</fontSizeAuto>
      <cursor>pointer</cursor>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel11">
      <left>2</left>
      <top>1</top>
      <width>268</width>
      <height>57</height>
      <leftRatio>0.00171821305841924</leftRatio>
      <topRatio>0.0163934426229508</topRatio>
      <widthRatio>0.195876288659794</widthRatio>
      <heightRatio>0.934426229508197</heightRatio>
      <sizeRatio>0.5</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>empty</backgroundSkin>
      <onClick>window.location.href = ee.pageRoot + "/regNewUser/regCoach2";
</onClick>
    </control>
  </controls>
  <taskSet count="2">
    <taskSetItem name="checkName">
      <script1><![CDATA[var name = ee.getEditText(ee.getControl("edit1"));
if (name.length<=0) {
    return;
}
eio.appendString8(name);
]]></script1>
      <script2><![CDATA[var name = eio.readString8();
var trim = function (str){ //删除左右两端的空格 
    return str.replace(/(^\s*)|(\s*$)/g, ""); 
}
name = trim(name);
while (true) {
    if (name.length<2) {
        eio.appendString8("F");
        eio.appendString8("名字必须大于2个字符的长度");
        break;
    }
    var sql = "select * from userInfo where nickName='" + db.encode(name) + "'";
    var sqlResult = db.executeQuery("PJ", sql);
    if (sqlResult == null) {
        eio.appendString8("F");
        eio.appendString8("系统繁忙请稍后再试");
        break;
    }
    if (db.read(sqlResult)) {
        eio.appendString8("F");
        eio.appendString8("昵称已经存在，请换个名字");
        break;
    }
    eio.appendString8("T");
    break;
} 

]]></script2>
      <script3>if (eio.readString8()!="T") {
    alert("检测昵称失败：" + eio.readString8());
    return;
}
alert("恭喜您，这个名字可以使用");
 

</script3>
    </taskSetItem>
    <taskSetItem name="reg">
      <script1>var password1 = ee.getEditText(ee.getControl("edit2"));
var password2 = ee.getEditText(ee.getControl("edit3"));
if (password1!=password2) {
    alert("对不起，您两次输入的密码不一致，请重新输入。");
    return;
}
eio.appendString8(ee.getEditText(ee.getControl("edit1")));
eio.appendString8(password1);

</script1>
      <script2><![CDATA[var nickName = eio.readString8();
var password = eio.readString8();
var trim = function (str){ //删除左右两端的空格 
    return str.replace(/(^\s*)|(\s*$)/g, ""); 
}
nickName = trim(nickName);
password = trim(password);
//用户端输入检测
if (nickName.length<2) {
    eio.appendString8("F");
    eio.appendString8("名字必须大于2个字符的长度");
    return;
}  
if (nickName.length>10) {
    eio.appendString8("F");
    eio.appendString8("名字必须小于10个字符的长度");
    return;
}
if (password.length<6) {
    eio.appendString8("F");
    eio.appendString8("密码的长度至少要6位，请重新输入");
    return;
}
//检测名字是否存在
var sql = "select * from userInfo where nickName='" + db.encode(nickName) + "'";
var sqlResult = db.executeQuery("PJ", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}
if (db.read(sqlResult)) {
    eio.appendString8("F");
    eio.appendString8("昵称已经存在，请换个名字");
    return;
}
//检测用户手机号是否存在
sql = "select * from userInfo where mobile = '" +
    db.encode(session.get("mobile")) + "'";
sqlResult = db.executeQuery("PJ", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}
if (db.read(sqlResult)) {
    eio.appendString8("F");
    eio.appendString8("您输入的手机号码已经被注册使用过，请通过密码找回的形式获得您以前注册的账号");
    return;
}
//检测前面的手机认证是否通过
if (session.get("mobileCheck")!="true") {
    eio.appendString8("F");
    eio.appendString8("您的手机没有通过认证，请返回上个页面重新进行一次手机验证码认证");
    return;
}
//创建用户
sql = "exec createUser '" + db.encode(session.get("mobile")) + "'";
sqlResult = db.executeQuery("PJ", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "resultCode")!=0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "resultString"));
    return;
}
//设置用户昵称和密码
sql = "update userInfo set " +
    "nickName = '" + db.encode(nickName) + "', " +
    "password = '" + es.getMd5(password) + "' " +
    "where mobile = '" + db.encode(session.get("mobile")) + "'";
if (!db.executeNoneQuery("PJ", sql)) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}  
es.logWarning("用户注册成功：" + session.get("mobile"));
//login
sql = "exec login '" + db.encode(session.get("mobile")) + "'," +
    "'" + es.getMd5(password) + "'";
sqlResult = db.executeQuery("PJ", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode")!=0) {
    eio.appendString8("F");
    es.logWarning("失败："+db.getString(sqlResult, "errorString"));
    eio.appendString8(db.getString(sqlResult, "errorString"));
    es.logWarning("用户登录失败,username=" + session.get("mobile") + ",password=" + password);
    return;
} 
eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));
es.logCommon("用户登录：" + session.get("mobile"));
]]></script2>
      <script3>if (eio.readString8()!="T") {
    alert("注册用户失败：" + eio.readString8());
    return;
}
//获取令牌
eb.setCookie("pjToken", eio.readString8());  
window.location.href = ee.pageRoot + "/regNewUser/regCoach4";

</script3>
    </taskSetItem>
  </taskSet>
  <gridLines count="0" />
</page>