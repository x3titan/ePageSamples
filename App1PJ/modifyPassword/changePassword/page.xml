<page>
  <controls count="12">
    <control type="DivRoot" pathname="/divRoot">
      <left>0</left>
      <top>0</top>
      <width>1215</width>
      <height>819</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>ffffff</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
    </control>
    <control type="LayoutY" pathname="/divRoot/layouty1">
      <left>0</left>
      <top>0</top>
      <width>1215</width>
      <height>90</height>
      <widthRatio>1</widthRatio>
      <heightRatio>0.10989010989011</heightRatio>
      <sizeRatio>0.0740740740740741</sizeRatio>
      <dockX>fill</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem1">
      <left>0</left>
      <top>0</top>
      <width>1215</width>
      <height>29</height>
      <widthRatio>1</widthRatio>
      <heightRatio>0.318840579710145</heightRatio>
      <sizeRatio>0.0409683426443203</sizeRatio>
      <backgroundColor>BFCEDF</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <heavy>47</heavy>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem2">
      <left>0</left>
      <top>29</top>
      <width>1215</width>
      <height>61</height>
      <topRatio>0.318840579710145</topRatio>
      <widthRatio>1</widthRatio>
      <heightRatio>0.681159420289855</heightRatio>
      <sizeRatio>0.0875232774674116</sizeRatio>
      <backgroundColor>47A9F9</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <text>修改密码</text>
      <fontSizeAuto>15</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel6">
      <left>33</left>
      <top>13</top>
      <width>144</width>
      <height>34</height>
      <leftRatio>0.0274442538593482</leftRatio>
      <topRatio>0.213114754098361</topRatio>
      <widthRatio>0.118353344768439</widthRatio>
      <heightRatio>0.557377049180328</heightRatio>
      <sizeRatio>0.492753623188406</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundImg>back.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <fontSizeAuto>30</fontSizeAuto>
      <cursor>pointer</cursor>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel7">
      <left>2</left>
      <top>1</top>
      <width>238</width>
      <height>57</height>
      <leftRatio>0.00164609053497942</leftRatio>
      <topRatio>0.0163934426229508</topRatio>
      <widthRatio>0.195884773662551</widthRatio>
      <heightRatio>0.934426229508197</heightRatio>
      <sizeRatio>0.239495798319328</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>empty</backgroundSkin>
      <onClick>window.location.href = ee.pageRoot + "/modifyPassword";

</onClick>
    </control>
    <control type="Panel" pathname="/divRoot/panel5">
      <left>48</left>
      <top>169</top>
      <width>1119</width>
      <height>294</height>
      <leftRatio>0.0395061728395062</leftRatio>
      <topRatio>0.206349206349206</topRatio>
      <widthRatio>0.920987654320988</widthRatio>
      <heightRatio>0.358974358974359</heightRatio>
      <sizeRatio>0.262734584450402</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>body4</backgroundSkin>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <aniAlpha>whiteAlpha:白色淡出</aniAlpha>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel1">
      <left>122</left>
      <top>71</top>
      <width>270</width>
      <height>51</height>
      <leftRatio>0.109011627906977</leftRatio>
      <topRatio>0.241496598639456</topRatio>
      <widthRatio>0.241279069767442</widthRatio>
      <heightRatio>0.173469387755102</heightRatio>
      <sizeRatio>0.307228915662651</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <text>新密码</text>
      <fontSizeAuto>35</fontSizeAuto>
    </control>
    <control type="Edit" pathname="/divRoot/panel5/edit1">
      <left>410</left>
      <top>74</top>
      <width>569</width>
      <height>45</height>
      <leftRatio>0.366071428571429</leftRatio>
      <topRatio>0.250825082508251</topRatio>
      <widthRatio>0.508928571428571</widthRatio>
      <heightRatio>0.151815181518152</heightRatio>
      <sizeRatio>0.201754385964912</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>line3</backgroundSkin>
      <inputPassword>true</inputPassword>
      <inputFontSizeAuto>20</inputFontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel2">
      <left>115</left>
      <top>139</top>
      <width>285</width>
      <height>51</height>
      <leftRatio>0.103197674418605</leftRatio>
      <topRatio>0.472789115646259</topRatio>
      <widthRatio>0.254360465116279</widthRatio>
      <heightRatio>0.173469387755102</heightRatio>
      <sizeRatio>0.291428571428571</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <text>再次输入密码</text>
      <fontSizeAuto>35</fontSizeAuto>
    </control>
    <control type="Edit" pathname="/divRoot/panel5/edit2">
      <left>410</left>
      <top>142</top>
      <width>569</width>
      <height>45</height>
      <leftRatio>0.366071428571429</leftRatio>
      <topRatio>0.481848184818482</topRatio>
      <widthRatio>0.508928571428571</widthRatio>
      <heightRatio>0.151815181518152</heightRatio>
      <sizeRatio>0.201754385964912</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>line3</backgroundSkin>
      <inputPassword>true</inputPassword>
      <inputFontSizeAuto>20</inputFontSizeAuto>
    </control>
    <control type="Panel" pathname="/divRoot/panel8">
      <left>222</left>
      <top>566</top>
      <width>770</width>
      <height>51</height>
      <leftRatio>0.182716049382716</leftRatio>
      <topRatio>0.691086691086691</topRatio>
      <widthRatio>0.633744855967078</widthRatio>
      <heightRatio>0.0622710622710623</heightRatio>
      <sizeRatio>0.0662337662337662</sizeRatio>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <backgroundSkin>button3</backgroundSkin>
      <text>确 定</text>
      <fontSizeAuto>20</fontSizeAuto>
      <fontColor>FFFFFF</fontColor>
      <cursor>pointer</cursor>
      <onClick>modifyPassword();</onClick>
    </control>
  </controls>
  <taskSet count="1">
    <taskSetItem name="modifyPassword">
      <script1><![CDATA[var password1 = ee.getEditText(ee.getControl("edit1"));
var password2 = ee.getEditText(ee.getControl("edit2"));
if (password1.length < 6) {
    alert("新密码的长度至少需要6位，请重新输入");
    return;
}
if (password1 != password2) {
    alert("对不起，您两次输入的密码不一致，请重新输入。");
    return;
} 
eio.appendString8(eb.getCookie("pjToken"));
eio.appendString8(password1);

]]></script1>
      <script2><![CDATA[var token = eio.readString8();
var password = eio.readString8();
var passwordMd5 = es.getMd5(password);
var sql,sqlResult;
sql = "exec getUserInfoBySession '" + db.encode(token) + "'";
sqlResult = db.executeQuery("PJ", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("token失效");
    es.logWarning("用户token失效, sql=" + sql);
    return;
} 
var userId = db.getInt32(sqlResult, "id");

sql = "update userInfo set password = '" + db.encode(passwordMd5) + "' where id=" + userId;
var sqlResult = db.executeNoneQuery("PJ", sql);
if (!sqlResult) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}

eio.appendString8("T");
]]></script2>
      <script3>if (eio.readString8()!="T") {
    alert("密码需改失败，请稍后再试：" + eio.readString8());
    return;
}
alert("密码修改成功，请牢记您的新密码");
if (eb.getCookie("pjUserType")=="教练") {
    window.location.href = ee.pageRoot + "/cMain";
} else {
    window.location.href = ee.pageRoot + "/student/sMain";
}


</script3>
    </taskSetItem>
  </taskSet>
  <gridLines count="0" />
</page>