<page>
  <controls count="20">
    <control type="DivRoot" pathname="/divRoot">
      <backgroundColor>FFFFFF</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <height>816</height>
      <left>0</left>
      <onControlLoad>var isIOS = !!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
if (!isIOS) {
    ee.getControl("layoutyitem1").heavy = 0;
}
setTimeout(function(){
    ee.autoResize = false;
},1000);

getSession();</onControlLoad>
      <pageHead><![CDATA[<meta name="viewport" content="width=device-width, minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="format-detection" content="telephone=no"/>]]></pageHead>
      <top>0</top>
      <width>451</width>
    </control>
    <control type="Panel" pathname="/divRoot/panel8">
      <backgroundImg>com.png</backgroundImg>
      <cursor>pointer</cursor>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontColor>FFFFFF</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>20</fontSizeAuto>
      <height>60</height>
      <heightRatio>0.0735294117647059</heightRatio>
      <left>6</left>
      <leftRatio>0.0133037694013304</leftRatio>
      <onClick>modifyPassword();</onClick>
      <sizeRatio>0.137299771167048</sizeRatio>
      <top>303</top>
      <topRatio>0.371323529411765</topRatio>
      <width>437</width>
      <widthRatio>0.968957871396896</widthRatio>
    </control>
    <control type="LayoutX" pathname="/divRoot/layoutx1">
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
      <height>53</height>
      <heightRatio>0.0647130647130647</heightRatio>
      <left>7</left>
      <leftRatio>0.0155210643015521</leftRatio>
      <sizeRatio>0.121281464530892</sizeRatio>
      <top>130</top>
      <topRatio>0.158730158730159</topRatio>
      <width>437</width>
      <widthRatio>0.968957871396896</widthRatio>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layoutx1/layoutxitem1">
      <backgroundColor>f0f0f0</backgroundColor>
      <fontColor>505050</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>20</fontSizeAuto>
      <hAlign>left</hAlign>
      <heavy>80</heavy>
      <height>53</height>
      <heightRatio>1</heightRatio>
      <left>0</left>
      <sizeRatio>0.0981481481481482</sizeRatio>
      <text>新密码</text>
      <top>0</top>
      <width>194</width>
      <widthRatio>0.444078947368421</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layoutx1/layoutxitem1/panel2">
      <backgroundColor>C0C0C0</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>fill</dockX>
      <dockY>bottom</dockY>
      <height>1</height>
      <heightRatio>0.0188679245283019</heightRatio>
      <left>0</left>
      <sizeRatio>0.00185185185185185</sizeRatio>
      <top>52</top>
      <topRatio>0.981132075471698</topRatio>
      <width>194</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layoutx1/layoutxitem2">
      <backgroundColor>d0d0d0</backgroundColor>
      <height>53</height>
      <heightRatio>1</heightRatio>
      <left>194</left>
      <leftRatio>0.444078947368421</leftRatio>
      <sizeRatio>0.0784023668639053</sizeRatio>
      <top>0</top>
      <width>243</width>
      <widthRatio>0.555921052631579</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/layoutx1/layoutxitem2/edit1">
      <backgroundSkin>empty</backgroundSkin>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fontColor>B5B5B5</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>20</fontSizeAuto>
      <hAlign>left</hAlign>
      <height>53</height>
      <heightRatio>1</heightRatio>
      <inputFont>黑体</inputFont>
      <inputFontSizeAuto>20</inputFontSizeAuto>
      <inputPassword>true</inputPassword>
      <left>0</left>
      <sizeRatio>0.0784023668639053</sizeRatio>
      <text>请输入新密码</text>
      <top>0</top>
      <width>243</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layoutx1/layoutxitem2/panel1">
      <backgroundColor>C0C0C0</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>fill</dockX>
      <dockY>bottom</dockY>
      <height>1</height>
      <heightRatio>0.0188679245283019</heightRatio>
      <left>0</left>
      <sizeRatio>0.0014792899408284</sizeRatio>
      <top>52</top>
      <topRatio>0.981132075471698</topRatio>
      <width>243</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutY" pathname="/divRoot/layouty1">
      <dockX>fill</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
      <height>90</height>
      <heightRatio>0.10989010989011</heightRatio>
      <left>0</left>
      <sizeRatio>0.204081632653061</sizeRatio>
      <top>0</top>
      <width>451</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem1">
      <backgroundColor>BFCEDF</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <heavy>47</heavy>
      <height>29</height>
      <heightRatio>0.322222222222222</heightRatio>
      <left>0</left>
      <sizeRatio>0.0231075697211155</sizeRatio>
      <top>0</top>
      <width>451</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem2">
      <backgroundColor>47A9F9</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <fontColor>FFFFFF</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>15</fontSizeAuto>
      <height>61</height>
      <heightRatio>0.677777777777778</heightRatio>
      <left>0</left>
      <sizeRatio>0.048605577689243</sizeRatio>
      <text>忘记密码</text>
      <top>29</top>
      <topRatio>0.322222222222222</topRatio>
      <width>451</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel89">
      <backgroundImg>back.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontSizeAuto>30</fontSizeAuto>
      <height>34</height>
      <heightRatio>0.557377049180328</heightRatio>
      <left>12</left>
      <leftRatio>0.0274442538593482</leftRatio>
      <sizeRatio>0.492753623188406</sizeRatio>
      <top>13</top>
      <topRatio>0.213114754098361</topRatio>
      <width>53</width>
      <widthRatio>0.118353344768439</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel90">
      <backgroundSkin>empty</backgroundSkin>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <height>57</height>
      <heightRatio>0.934426229508197</heightRatio>
      <left>1</left>
      <leftRatio>0.00157728706624606</leftRatio>
      <onClick>if(eb.getCookie("logined") == "T"){
    //alert(1); 
    eb.setCookie("logined","F");
    window.location.href = ee.pageRoot + "/modifyPassword/loginRestPWD";
} else { 
   // alert(2);
    window.location.href = ee.pageRoot + "/modifyPassword/resetPassword1";
}


</onClick>
      <sizeRatio>0.22007722007722</sizeRatio>
      <top>1</top>
      <topRatio>0.0163934426229508</topRatio>
      <width>184</width>
      <widthRatio>0.408517350157729</widthRatio>
    </control>
    <control type="LayoutX" pathname="/divRoot/layoutx2">
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
      <height>53</height>
      <heightRatio>0.0647130647130647</heightRatio>
      <left>7</left>
      <leftRatio>0.0155210643015521</leftRatio>
      <sizeRatio>0.121281464530892</sizeRatio>
      <top>195</top>
      <topRatio>0.239316239316239</topRatio>
      <width>437</width>
      <widthRatio>0.968957871396896</widthRatio>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layoutx2/layoutxitem3">
      <backgroundColor>f0f0f0</backgroundColor>
      <fontColor>505050</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>20</fontSizeAuto>
      <hAlign>left</hAlign>
      <heavy>80</heavy>
      <height>53</height>
      <heightRatio>1</heightRatio>
      <left>0</left>
      <sizeRatio>0.0981481481481482</sizeRatio>
      <text>再次输入新密码</text>
      <top>0</top>
      <width>194</width>
      <widthRatio>0.444078947368421</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layoutx2/layoutxitem3/panel3">
      <backgroundColor>C0C0C0</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>fill</dockX>
      <dockY>bottom</dockY>
      <height>1</height>
      <heightRatio>0.0188679245283019</heightRatio>
      <left>0</left>
      <sizeRatio>0.00185185185185185</sizeRatio>
      <top>52</top>
      <topRatio>0.981132075471698</topRatio>
      <width>194</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layoutx2/layoutxitem4">
      <backgroundColor>d0d0d0</backgroundColor>
      <height>53</height>
      <heightRatio>1</heightRatio>
      <left>194</left>
      <leftRatio>0.444078947368421</leftRatio>
      <sizeRatio>0.0784023668639053</sizeRatio>
      <top>0</top>
      <width>243</width>
      <widthRatio>0.555921052631579</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/layoutx2/layoutxitem4/edit2">
      <backgroundSkin>empty</backgroundSkin>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fontColor>B5B5B5</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>20</fontSizeAuto>
      <hAlign>left</hAlign>
      <height>53</height>
      <heightRatio>1</heightRatio>
      <inputFont>黑体</inputFont>
      <inputFontSizeAuto>20</inputFontSizeAuto>
      <inputPassword>true</inputPassword>
      <left>0</left>
      <sizeRatio>0.0784023668639053</sizeRatio>
      <text>再次输入新密码</text>
      <top>0</top>
      <width>243</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layoutx2/layoutxitem4/panel4">
      <backgroundColor>C0C0C0</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>fill</dockX>
      <dockY>bottom</dockY>
      <height>1</height>
      <heightRatio>0.0188679245283019</heightRatio>
      <left>0</left>
      <sizeRatio>0.0014792899408284</sizeRatio>
      <top>52</top>
      <topRatio>0.981132075471698</topRatio>
      <width>243</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel16">
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontColor>C7C7C7</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>left</hAlign>
      <height>40</height>
      <heightRatio>0.0490196078431373</heightRatio>
      <left>8</left>
      <leftRatio>0.0177383592017738</leftRatio>
      <sizeRatio>0.097799511002445</sizeRatio>
      <text>密码长度为6-15个字符，最好同时包含数字和字母</text>
      <top>256</top>
      <topRatio>0.313725490196078</topRatio>
      <width>409</width>
      <widthRatio>0.906873614190687</widthRatio>
    </control>
  </controls>
  <taskSet count="3">
    <taskSetItem name="modifyPassword">
      <script1><![CDATA[var password1 = ee.getEditText(ee.getControl("edit1"));
var password2 = ee.getEditText(ee.getControl("edit2"));
if (password1.length < 6) {
    alert("新密码的长度至少需要6位，请重新输入");
    return;
}
if (password1.length > 15) {
    alert("新密码的长度最多为15位，请重新输入");
    return;
}
if (password1 != password2) {
    alert("对不起，您两次输入的密码不一致，请重新输入。");
    return;
} 
eio.appendString8(password1);

]]></script1>
      <script2>if (session.get("mobileCheck") != "true") {
    eio.appendString8("F");
    eio.appendString8("没有通过手机验证");
    return;
}
var mobile = session.get("mobile");
if (mobile.length!=11) {
    eio.appendString8("F");
    eio.appendString8("没有通过手机验证");
    return;
}
session.set("mobileCheck", "false"); //手机验证仅一次有效

var password = eio.readString8();
var passwordMd5 = es.getMd5(password);
var sql,sqlResult;
sql = "update userInfo set password = '" + 
    db.encode(passwordMd5) + 
    "' where mobile='" + db.encode(mobile) + "'";
var sqlResult = db.executeNoneQuery("PJ", sql);
if (!sqlResult) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}

eio.appendString8("T");
eio.appendString8(mobile);
</script2>
      <script3>if (eio.readString8()!="T") {
    alert("无法修改密码：" + eio.readString8());
    return;
}
g5.username = eio.readString8();
alert("密码修改成功，请牢记您的新密码"); 

login();

</script3>
    </taskSetItem>
    <taskSetItem name="login">
      <script1>g5.password = ee.getEditText(ee.getControl("edit1"));
eio.appendString8(g5.username);
eio.appendString8(g5.password);

</script1>
      <script2>var username = eio.readString8();
var password = eio.readString8();
var passwordMd5 = es.getMd5(password);
var sql,sqlResult;
sql = "exec login '" + db.encode(username) + "'," +
    "'" + passwordMd5 + "'";
sqlResult = db.executeQuery("PJ", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode")!=0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    es.logCommon("用户登录失败,username=" + username + ",password=" + password);
    return;
} 
eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));
es.logCommon("用户通过密码找回登录：" + username);
</script2>
      <script3>if (eio.readString8()!="T") {
    alert("登录失败：" + eio.readString8());
    window.location.href = ee.pageRoot + "/loginCon";
    return;
}
//获取令牌
//eb.setCookie("pjToken", eio.readString8());  
window.location.href = ee.pageRoot + "/loginCon";



</script3>
    </taskSetItem>
    <taskSetItem name="getSession">
      <script1 />
      <script2>eio.appendString8(session.get("pwd"));</script2>
      <script3>var s=eio.readString8();
if(s=="pwd"){
    ee.setText(ee.getControl("layoutyitem2"),"重置密码");
}</script3>
    </taskSetItem>
  </taskSet>
  <gridLines count="0" />
</page>