<page>
  <controls count="18">
    <control type="DivRoot" pathname="/divRoot">
      <backgroundColor>ffffff</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <height>799</height>
      <left>0</left>
      <onControlLoad>var isIOS = !!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
if (!isIOS) {
    ee.getControl("layoutyitem1").heavy = 0;
}
setTimeout(function(){
    ee.autoResize = false;
},1000);
g5.show = function(index) {
    /*if (index==0) {
        ee.setVisible(ee.getControl("panel6"), true);
        ee.setVisible(ee.getControl("panel4"), false);
        //ee.showAni(ee.getControl("panel11"));
        //ee.showAni(ee.getControl("panel12"));
    } else {
        ee.setVisible(ee.getControl("panel6"), false);
        ee.setVisible(ee.getControl("panel4"), true);
         ee.showAni(ee.getControl("panel4"));
        ee.showAni(ee.getControl("panel5"));
        ee.showAni(ee.getControl("panel7"));
        ee.showAni(ee.getControl("panel3")); 
        ee.showAni(ee.getControl("panel9"));
        ee.showAni(ee.getControl("panel8"));
       
        //ee.setVisible(ee.getControl("panel12"), false);
    } */ 
    
}


//是否可以自动登录
ee.setVisible(ee.getControl("panel6"), true);
/*setTimeout(function() {
    g5.token = eb.getCookie("pjToken");
    if (g5.token!=null) {
        g5.show(0);
        loginToken();
    } else {
        g5.show(1);
    }
}, 500);*/

setTimeout(function(){
    ee.autoResize = false;
},1000);
            

getMobile();
</onControlLoad>
      <pageHead><![CDATA[<meta name="viewport" content="width=device-width, minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">]]></pageHead>
      <top>0</top>
      <width>447</width>
    </control>
    <control type="LayoutY" pathname="/divRoot/layouty1">
      <dockX>fill</dockX>
      <dockY>ratio</dockY>
      <fieldCount>2</fieldCount>
      <height>88</height>
      <heightRatio>0.10989010989011</heightRatio>
      <left>0</left>
      <sizeRatio>0.138461538461538</sizeRatio>
      <top>0</top>
      <width>447</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem1">
      <backgroundColor>BFCEDF</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <heavy>47</heavy>
      <height>28</height>
      <heightRatio>0.318181818181818</heightRatio>
      <left>0</left>
      <sizeRatio>0.0626398210290828</sizeRatio>
      <top>0</top>
      <width>447</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem2">
      <backgroundColor>47A9F9</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <fontColor>FFFFFF</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>15</fontSizeAuto>
      <height>60</height>
      <heightRatio>0.681818181818182</heightRatio>
      <left>0</left>
      <sizeRatio>0.134228187919463</sizeRatio>
      <text>登录</text>
      <top>28</top>
      <topRatio>0.318181818181818</topRatio>
      <width>447</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel89">
      <backgroundImg>back.gif</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontSizeAuto>30</fontSizeAuto>
      <height>33</height>
      <heightRatio>0.557377049180328</heightRatio>
      <left>12</left>
      <leftRatio>0.0270855904658722</leftRatio>
      <sizeRatio>0.311926605504587</sizeRatio>
      <top>13</top>
      <topRatio>0.213114754098361</topRatio>
      <width>53</width>
      <widthRatio>0.118093174431203</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel90">
      <backgroundSkin>empty</backgroundSkin>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <height>56</height>
      <heightRatio>0.934426229508197</heightRatio>
      <left>1</left>
      <leftRatio>0.00258397932816537</leftRatio>
      <onClick>window.location.href = ee.pageRoot + "/login";
</onClick>
      <sizeRatio>0.360759493670886</sizeRatio>
      <top>1</top>
      <topRatio>0.0163934426229508</topRatio>
      <width>182</width>
      <widthRatio>0.408268733850129</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel5">
      <aniAlpha>whiteAlpha:白色淡出</aniAlpha>
      <aniPos>topFlyIn:顶部飞入</aniPos>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontColor>FFFFFF</fontColor>
      <fontSizeAuto>20</fontSizeAuto>
      <height>268</height>
      <heightRatio>0.335775335775336</heightRatio>
      <left>0</left>
      <sizeRatio>0.257731958762887</sizeRatio>
      <top>128</top>
      <topRatio>0.15995115995116</topRatio>
      <width>447</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel1">
      <backgroundColor>00C0C0</backgroundColor>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontColor>5F5F5F</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>20</fontSizeAuto>
      <height>64</height>
      <heightRatio>0.237226277372263</heightRatio>
      <left>56</left>
      <leftRatio>0.125244618395303</leftRatio>
      <sizeRatio>0.670103092783505</sizeRatio>
      <text>手机号</text>
      <top>69</top>
      <topRatio>0.259124087591241</topRatio>
      <width>85</width>
      <widthRatio>0.189823874755382</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/panel5/edit1">
      <backgroundSkin>empty</backgroundSkin>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontColor>C7C7C7</fontColor>
      <fontSizeAuto>22</fontSizeAuto>
      <hAlign>left</hAlign>
      <height>57</height>
      <heightRatio>0.211678832116788</heightRatio>
      <inputFont>黑体</inputFont>
      <inputFontSizeAuto>20</inputFontSizeAuto>
      <left>149</left>
      <leftRatio>0.332681017612524</leftRatio>
      <sizeRatio>0.242677824267782</sizeRatio>
      <text>请输入手机号</text>
      <top>72</top>
      <topRatio>0.27007299270073</topRatio>
      <width>209</width>
      <widthRatio>0.467710371819961</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/panel5/edit2">
      <backgroundSkin>empty</backgroundSkin>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontColor>C7C7C7</fontColor>
      <fontSizeAuto>22</fontSizeAuto>
      <hAlign>left</hAlign>
      <height>52</height>
      <heightRatio>0.192727272727273</heightRatio>
      <inputFont>黑体</inputFont>
      <inputFontSizeAuto>20</inputFontSizeAuto>
      <inputPassword>true</inputPassword>
      <left>149</left>
      <leftRatio>0.332533013205282</leftRatio>
      <sizeRatio>0.144021739130435</sizeRatio>
      <text>请输入密码</text>
      <top>180</top>
      <topRatio>0.672727272727273</topRatio>
      <width>197</width>
      <widthRatio>0.441776710684274</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel2">
      <backgroundColor>00C0C0</backgroundColor>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontColor>5F5F5F</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>20</fontSizeAuto>
      <height>63</height>
      <heightRatio>0.236363636363636</heightRatio>
      <left>56</left>
      <leftRatio>0.1252408477842</leftRatio>
      <sizeRatio>0.844155844155844</sizeRatio>
      <text>密码</text>
      <top>174</top>
      <topRatio>0.650909090909091</topRatio>
      <width>66</width>
      <widthRatio>0.148362235067437</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel7">
      <aniDelay>300</aniDelay>
      <aniPos>bottomBonus:底部落入</aniPos>
      <backgroundColor>FFFFFF</backgroundColor>
      <cursor>pointer</cursor>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontColor>47A9F9</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>30</fontSizeAuto>
      <hAlign>right</hAlign>
      <height>46</height>
      <heightRatio>0.172897196261682</heightRatio>
      <left>347</left>
      <leftRatio>0.775725593667546</leftRatio>
      <onClick>pwdSession();

 </onClick>
      <sizeRatio>0.493333333333333</sizeRatio>
      <text>忘记密码？</text>
      <top>183</top>
      <topRatio>0.682242990654206</topRatio>
      <width>88</width>
      <widthRatio>0.197889182058047</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel4">
      <backgroundImg>mobile@2x.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <height>36</height>
      <heightRatio>0.134545454545455</heightRatio>
      <left>27</left>
      <leftRatio>0.0597302504816956</leftRatio>
      <sizeRatio>0.925</sizeRatio>
      <top>77</top>
      <topRatio>0.287272727272727</topRatio>
      <width>34</width>
      <widthRatio>0.0770712909441233</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel6">
      <backgroundImg>password@2x.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <height>36</height>
      <heightRatio>0.134545454545455</heightRatio>
      <left>27</left>
      <leftRatio>0.0597302504816956</leftRatio>
      <sizeRatio>0.925</sizeRatio>
      <top>181</top>
      <topRatio>0.676363636363636</topRatio>
      <width>34</width>
      <widthRatio>0.0770712909441233</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel3">
      <alpha>0.5</alpha>
      <backgroundColor>C0C0C0</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <height>2</height>
      <heightRatio>0.00727272727272727</heightRatio>
      <left>20</left>
      <leftRatio>0.0453514739229025</leftRatio>
      <outerLeft>20</outerLeft>
      <outerRight>20</outerRight>
      <sizeRatio>0.00498753117206983</sizeRatio>
      <top>238</top>
      <topRatio>0.887272727272727</topRatio>
      <width>406</width>
      <widthRatio>0.909297052154195</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel5/panel11">
      <alpha>0.5</alpha>
      <backgroundColor>C0C0C0</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <height>2</height>
      <heightRatio>0.00727272727272727</heightRatio>
      <left>20</left>
      <leftRatio>0.0453514739229025</leftRatio>
      <outerLeft>20</outerLeft>
      <outerRight>20</outerRight>
      <sizeRatio>0.00498753117206983</sizeRatio>
      <top>134</top>
      <topRatio>0.498181818181818</topRatio>
      <width>406</width>
      <widthRatio>0.909297052154195</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel8">
      <aniPos>bottomBonus:底部落入</aniPos>
      <backgroundColor>47A9F9</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <cursor>pointer</cursor>
      <dockX>ratio</dockX>
      <dockY>ratio</dockY>
      <fontColor>FFFFFF</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSizeAuto>20</fontSizeAuto>
      <height>65</height>
      <heightRatio>0.0818070818070818</heightRatio>
      <left>20</left>
      <leftRatio>0.0440487347703843</leftRatio>
      <onClick>//alert(ee.getEditText(ee.getControl("edit1")))
login();</onClick>
      <sizeRatio>0.0706751054852321</sizeRatio>
      <text>登 录</text>
      <top>449</top>
      <topRatio>0.561660561660562</topRatio>
      <width>397</width>
      <widthRatio>0.888472352389878</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel9">
      <backgroundImg>loginWait.jpg</backgroundImg>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <height>799</height>
      <heightRatio>1</heightRatio>
      <layerName>等待页面</layerName>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <sizeRatio>1.78747203579418</sizeRatio>
      <top>0</top>
      <width>447</width>
      <widthRatio>1</widthRatio>
    </control>
  </controls>
  <taskSet count="4">
    <taskSetItem name="login">
      <script1><![CDATA[g5.username = ee.getEditText(ee.getControl("edit1"));
g5.password = ee.getEditText(ee.getControl("edit2"));

if (g5.username == "111111") {
    window.location.href = ee.getUrl("/testPage");
    return;
}



if(g5.password.length<=0){
    alert("请输入密码");
    return; 
} 
if (g5.username.length!=11) {
    alert("请输入有效的手机号码");
    return;
}
 

eio.appendString8(g5.username);
eio.appendString8(g5.password);

]]></script1>
      <script2><![CDATA[var username = eio.readString8();
var password = eio.readString8();
var passwordMd5 = es.getMd5(password);
var sql,sqlResult;  

sql="select * from userInfo where mobile='" + db.encode(username) +"'";                   
sqlResult = db.executeQuery("PJ", sql);  
db.read(sqlResult);
var userT=db.getString(sqlResult,"userType");  
var applyS=db.getString(sqlResult,"autoStatus");  
var passwordL=db.getString(sqlResult,"password"); 
var enabled=db.getString(sqlResult,"enabled"); 
if(enabled=="F"){ //判断帐号是否是已删除
    eio.appendString8("T2"); 
    session.set("mobile", username) 
    return;  
}  
/*
es.logWarning(username);
es.logWarning(password);
es.logWarning(passwordMd5); 
es.logWarning(passwordL);
es.logWarning(sql);
es.logWarning(userT);
es.logWarning(applyS);
  */    

sql = "exec login '" + db.encode(username) + "'," +
    "'" + passwordMd5 + "'";
sqlResult = db.executeQuery("PJ", sql);   
//es.logWarning(sql);
if (sqlResult == null) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode")!=0) {    
    eio.appendString8("");
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    es.logCommon("用户登录失败,username=" + username + ",password=" + password);
    return;
}   
eio.appendString8(db.getString(sqlResult, "errorString"));//errorCode=0时 返回的是token的值

if((userT=="教练")&amp;&amp;(applyS=="CNN" || applyS=="VNN")&amp;&amp;(passwordL==passwordMd5)){      //&amp;&amp;applyS=="F" 
    eio.appendString8("T1"); 
    session.set("mobile", username); 
    return;
}  
if((userT=="教练")&amp;&amp;(applyS=="CNN" || applyS=="VNN")&amp;&amp;(passwordL=="")){//||(passwordL.length<=0)){
    eio.appendString8("T1"); 
    session.set("mobile", username); 
    return;
} 
if((userT=="教练")&amp;&amp;(applyS=="NNN")&amp;&amp;(passwordL==passwordMd5 )){      //&amp;&amp;applyS=="F" 
    eio.appendString8("T3"); 
    session.set("mobile", username); 
    return;
} 
if((userT=="教练")&amp;&amp;(applyS=="NNN")&amp;&amp;(passwordL=="" )){      //&amp;&amp;applyS=="F" 
    eio.appendString8("T3"); 
    session.set("mobile", username); 
    return;
}  
if((userT=="教练")&amp;&amp;(applyS=="")&amp;&amp;(passwordL==passwordMd5 )){      //&amp;&amp;applyS=="F" 
    eio.appendString8("T3"); 
    session.set("mobile", username); 
    return;
} 
if((userT=="教练")&amp;&amp;(applyS=="")&amp;&amp;(passwordL=="" )){      //&amp;&amp;applyS=="F" 
    eio.appendString8("T3"); 
    session.set("mobile", username); 
    return;
}
eio.appendString8("T");
//eio.appendString8(db.getString(sqlResult, "errorString"));
es.logCommon("用户登录：" + username);
]]></script2>
      <script3>eb.setCookie("pjToken", eio.readString8()); 
var resultCode=eio.readString8();     


if (resultCode=="F") {  
    alert("登录失败：" + eio.readString8());
    //g5.show(1);
    return;
}  

if (resultCode=="T1") {
    window.location.href=ee.pageRoot + "/regCoachCom"; 
   // eb.setCookie("pjToken", eio.readString8()); 
    return;
}
if (resultCode=="T2") {
    //window.location.href=ee.pageRoot + "/regNewCoach/newCoach5";
    alert("登录失败,帐号或密码不正确");
    return;
}  
if (resultCode=="T3") {
    //window.location.href=ee.pageRoot + "/regNewCoach/newCoach5";
    window.location.href=ee.pageRoot + "/regCoachNew";
    return;
}
//获取令牌
//eb.setCookie("pjToken", eio.readString8());  
loginToken();



</script3>
    </taskSetItem>
    <taskSetItem name="loginToken">
      <script1>g5.token = eb.getCookie("pjToken");
if (eb.isEmpty(g5.token)) {
    g5.show(1);
    return;              
}
eio.appendString8(g5.token);
</script1>
      <script2><![CDATA[var token = eio.readString8();
var sql,sqlResult;
sql = "exec getUserInfoBySession '" + db.encode(token) + "'";
sqlResult = db.executeQuery("PJ", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    eio.appendString8("系统繁忙请稍后再试");
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F1");
    //eio.appendString8("上次登录时间太久或者您更换了系统");
    eio.appendString8("请重新登录")
    es.logCommon("用户token登录失败,token=" + token);
    return;
} 
eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "userType"));   
eio.appendString8(db.getString(sqlResult, "mobile"))
es.logCommon("用户token登录,nickName=" + db.getString(sqlResult,"nickName")+
    ",mobile=" + db.getString(sqlResult, "mobile"));

]]></script2>
      <script3>var code = eio.readString8();
if (code !="T") { 
    if(code == "F1"){
        alert(eio.readString8());
    }else {
        alert("登录失败："+eio.readString8());
    }
    g5.show(1);
    return;
}
var userType = eio.readString8();  
var mobile = eio.readString8();
eb.setCookie("pjUserType", userType); 
//eb.setCookie("pjUserMobile",mobile);
if (userType=="教练") {  
    ee.setVisible(ee.getControl("panel9"),true);
    setTimeout("window.location.href = ee.pageRoot + \"/cMain\";",1000); 
} else {   
    ee.setVisible(ee.getControl("panel9"),true);
    setTimeout("window.location.href = ee.pageRoot + \"/student/sMain\";",1000); 
}

</script3>
    </taskSetItem>
    <taskSetItem name="pwdSession">
      <script1>eio.appendString8(ee.getEditText(ee.getControl("edit1")));</script1>
      <script2>session.set("pwd","a");       
session.set("mobileGET",eio.readString8());</script2>
      <script3>window.location.href = ee.pageRoot + "/modifyPassword/resetPassword1";</script3>
    </taskSetItem>
    <taskSetItem name="getMobile">
      <script1 />
      <script2>eio.appendString8(session.get("mobileGET"));</script2>
      <script3>var mobile = eio.readString8();
ee.setEditText(ee.getControl("edit1"),mobile);</script3>
    </taskSetItem>
  </taskSet>
  <gridLines count="0" />
</page>