<page>
  <controls count="39">
    <control type="DivRoot" pathname="/divRoot">
      <left>0</left>
      <top>0</top>
      <width>1322</width>
      <height>719</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>ffffff</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
    </control>
    <control type="Panel" pathname="/divRoot/panel39">
      <left>0</left>
      <top>0</top>
      <width>1322</width>
      <height>719</height>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <backgroundColor>F0F0F0</backgroundColor>
      <backgroundImg>xz_bn.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
    </control>
    <control type="Panel" pathname="/divRoot/panel39/panel22">
      <left>0</left>
      <top>671</top>
      <width>1322</width>
      <height>48</height>
      <dockX>fill</dockX>
      <dockY>bottom</dockY>
      <backgroundColor>008080</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <text>众 安 房 产 有 限 公 司</text>
      <fontSize>12</fontSize>
      <fontColor>FFFFFF</fontColor>
      <fontBold>true</fontBold>
    </control>
    <control type="Panel" pathname="/divRoot/panel33">
      <left>0</left>
      <top>0</top>
      <width>1322</width>
      <height>53</height>
      <dockX>fill</dockX>
      <dockY>top</dockY>
      <backgroundColor>DBE8DC</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
    </control>
    <control type="Panel" pathname="/divRoot/panel32">
      <left>161</left>
      <top>0</top>
      <width>1000</width>
      <height>719</height>
      <dockX>center</dockX>
      <dockY>fill</dockY>
      <backgroundColor>0000FF</backgroundColor>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel36">
      <left>28</left>
      <top>60</top>
      <width>276</width>
      <height>334</height>
      <backgroundImg>CPY0000.jpg</backgroundImg>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel1">
      <left>336</left>
      <top>72</top>
      <width>176</width>
      <height>38</height>
      <backgroundSkin>r005</backgroundSkin>
      <text>账户信息</text>
      <fontSize>12</fontSize>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel2">
      <left>498</left>
      <top>106</top>
      <width>463</width>
      <height>4</height>
      <backgroundColor>099CCC</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel3">
      <left>386</left>
      <top>124</top>
      <width>109</width>
      <height>22</height>
      <text>编号</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel4">
      <left>386</left>
      <top>153</top>
      <width>109</width>
      <height>22</height>
      <text>姓名</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel5">
      <left>386</left>
      <top>182</top>
      <width>109</width>
      <height>22</height>
      <text>分部</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel6">
      <left>386</left>
      <top>211</top>
      <width>109</width>
      <height>22</height>
      <text>部门</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel7">
      <left>386</left>
      <top>240</top>
      <width>109</width>
      <height>22</height>
      <text>直接上级</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel8">
      <left>386</left>
      <top>268</top>
      <width>109</width>
      <height>22</height>
      <text>岗位</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel9">
      <left>386</left>
      <top>297</top>
      <width>109</width>
      <height>22</height>
      <text>电话</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel10">
      <left>386</left>
      <top>326</top>
      <width>109</width>
      <height>22</height>
      <text>移动电话</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel11">
      <left>386</left>
      <top>355</top>
      <width>109</width>
      <height>22</height>
      <text>电子邮件</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel12">
      <left>502</left>
      <top>126</top>
      <width>3</width>
      <height>249</height>
      <backgroundColor>E0E0E0</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel13">
      <left>519</left>
      <top>124</top>
      <width>241</width>
      <height>22</height>
      <text><![CDATA[<%
if (userinfo.RYXX_JOBNUM.length==0) {
	"未填写";
} else {
	userinfo.RYXX_JOBNUM;
}
%>]]></text>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel14">
      <left>519</left>
      <top>153</top>
      <width>241</width>
      <height>22</height>
      <text><![CDATA[<%
if (userinfo.RYXX_NAME.length==0) {
	"未填写";
} else {
	userinfo.RYXX_NAME;
}
%>]]></text>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel15">
      <left>519</left>
      <top>182</top>
      <width>241</width>
      <height>22</height>
      <text><![CDATA[<%
if (userinfo.ZZGS_NAME.length==0) {
	"未填写";
} else {
	userinfo.ZZGS_NAME;
}
%>]]></text>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel16">
      <left>519</left>
      <top>211</top>
      <width>241</width>
      <height>22</height>
      <text><![CDATA[<% 
if (userinfo.ZZBM_NAME.length==0) {
	"未填写";
} else {
	userinfo.ZZBM_NAME
}
 %>]]></text>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel17">
      <left>519</left>
      <top>240</top>
      <width>241</width>
      <height>22</height>
      <text>未填写</text>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel18">
      <left>519</left>
      <top>268</top>
      <width>241</width>
      <height>22</height>
      <text><![CDATA[<%
if (userinfo.GWXX_POSTNAME.length==0) {
	"未填写";
} else {
	userinfo.GWXX_POSTNAME;
}
%>]]></text>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel19">
      <left>519</left>
      <top>297</top>
      <width>241</width>
      <height>22</height>
      <text><![CDATA[<%
if (userinfo.RYXX_TEL.length==0) {
	"未填写";
} else {
	userinfo.RYXX_TEL;
}
%>]]></text>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel20">
      <left>519</left>
      <top>326</top>
      <width>241</width>
      <height>22</height>
      <text><![CDATA[<%
if (userinfo.RYXX_MOBILE.length==0) {
	"未填写";
} else {
	userinfo.RYXX_MOBILE;
}
%>]]></text>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel21">
      <left>519</left>
      <top>355</top>
      <width>241</width>
      <height>22</height>
      <text><![CDATA[<%
if (userinfo.RYXX_EMAIL.length==0) {
	"未填写";
} else {
	userinfo.RYXX_EMAIL;
}
%>]]></text>
      <hAlign>left</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel23">
      <left>82</left>
      <top>418</top>
      <width>176</width>
      <height>38</height>
      <backgroundSkin>r005</backgroundSkin>
      <text>修改登录密码</text>
      <fontSize>12</fontSize>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel24">
      <left>242</left>
      <top>452</top>
      <width>721</width>
      <height>4</height>
      <backgroundColor>099CCC</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel25">
      <left>552</left>
      <top>536</top>
      <width>115</width>
      <height>29</height>
      <backgroundSkin>skin1</backgroundSkin>
      <text>修改</text>
      <fontColor>FFFFFF</fontColor>
      <onClick><![CDATA[
//输入合法性验证
var old = ee.getEditText(ee.getControl("edit1"));
var new1 = ee.getEditText(ee.getControl("edit2"));
var new2 = ee.getEditText(ee.getControl("edit3"));
if (new1.length<6) {
	alert("新密码长度至少应为6位，密码修改失败。");
	return;
}
if (new1!=new2) {
	alert("您两次输入的新密码不一致，密码修改失败。");
	return;
}
//修改密码
modifyPassword(old, new1);]]></onClick>
    </control>
    <control type="Edit" pathname="/divRoot/panel32/edit1">
      <left>338</left>
      <top>481</top>
      <width>186</width>
      <height>25</height>
      <backgroundSkin>edit1</backgroundSkin>
      <inputPassword>true</inputPassword>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel26">
      <left>217</left>
      <top>484</top>
      <width>109</width>
      <height>22</height>
      <text>原密码</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel27">
      <left>217</left>
      <top>513</top>
      <width>109</width>
      <height>22</height>
      <text>新密码</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel28">
      <left>217</left>
      <top>542</top>
      <width>109</width>
      <height>22</height>
      <text>确认新密码</text>
      <hAlign>right</hAlign>
    </control>
    <control type="Edit" pathname="/divRoot/panel32/edit2">
      <left>338</left>
      <top>510</top>
      <width>186</width>
      <height>25</height>
      <backgroundSkin>edit1</backgroundSkin>
      <inputPassword>true</inputPassword>
    </control>
    <control type="Edit" pathname="/divRoot/panel32/edit3">
      <left>338</left>
      <top>539</top>
      <width>186</width>
      <height>25</height>
      <backgroundSkin>edit1</backgroundSkin>
      <inputPassword>true</inputPassword>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel29">
      <left>92</left>
      <top>598</top>
      <width>866</width>
      <height>4</height>
      <backgroundColor>099CCC</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel30">
      <left>92</left>
      <top>605</top>
      <width>866</width>
      <height>4</height>
      <backgroundColor>099CCC</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
    </control>
    <control type="Panel" pathname="/divRoot/panel32/panel34">
      <left>25</left>
      <top>8</top>
      <width>420</width>
      <height>38</height>
      <text>账户信息</text>
      <fontFamily>黑体</fontFamily>
      <fontSize>20</fontSize>
      <fontBold>true</fontBold>
      <hAlign>left</hAlign>
    </control>
  </controls>
  <sqlResultSet count="1">
    <sqlResult name="userinfo">
      <sqlString><![CDATA[select r.ryxx_jobnum, r.ryxx_name, s.zzgs_name, b.zzbm_name,x.gwxx_postname,r.ryxx_tel,r.ryxx_mobile,r.ryxx_email
  from y_ryxx r
  left join y_zzbm b
    on r.zzbm_id = b.zzbm_id
  left join y_zzgs s
    on b.zzgs_id = s.zzgs_id
  left join y_gwxx x on r.gwxx_id = x.gwxx_id
where ryxx_jobnum='<% session.set("username", request.get("username")); request.get("username") %>']]></sqlString>
      <sqlConnection>ZAOracle</sqlConnection>
      <sqlStringDecode />
    </sqlResult>
  </sqlResultSet>
  <taskSet count="1">
    <taskSetItem name="modifyPassword">
      <script1>eio.appendString8(ee.getEditText(ee.getControl("edit1"))); //老密码
eio.appendString8(ee.getEditText(ee.getControl("edit2"))); //新密码
</script1>
      <script2>//session.set("username","700592");
var username = session.get("username");
var passOld = eio.readString8();
var passNew = eio.readString8();
passOld = es.getMd5(passOld);
passNew = es.getMd5(passNew);
var sqlString = "select * from y_ryxx where ryxx_jobnum='" +
	username + "' and (RYXX_PASSWORD='"+passOld+"' or (RYXX_PASSWORD is null) " +
	"or (RYXX_PASSWORD=''))";
var sqlResult = db.executeQuery("ZAOracle", sqlString);
if (db.read(sqlResult)) {
	sqlString = "update y_ryxx set ryxx_password='"+passNew+"' where ryxx_jobnum='"+username+"'";
	db.executeNoneQuery("ZAOracle", sqlString);
	sqlString = "update hrmresource set password='"+passNew+"' where LOGINID='"+username+"'";
	db.executeNoneQuery("ZAOracle2", sqlString);
	eio.appendString8("T");
} else {
	eio.appendString8("对不起，您输入的密码不正确");
}
</script2>
      <script3>var result = eio.readString8();
if (result=="T") {
	alert("密码修改成功");
	ee.setEditText(ee.getControl("edit1"), "");
	ee.setEditText(ee.getControl("edit2"), "");
	ee.setEditText(ee.getControl("edit3"), "");
} else {
	alert(result);
}</script3>
    </taskSetItem>
  </taskSet>
  <gridLines count="0" />
</page>